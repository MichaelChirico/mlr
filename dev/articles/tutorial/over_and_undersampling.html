<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Imbalanced Classification Problems • mlr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<link href="../../extra.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Imbalanced Classification Problems">
<meta property="og:description" content="mlr">
<meta property="og:image" content="https://mlr.mlr-org.com/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://mlr-org.com"><img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" id="hexlogo" alt="mlr-org"></a>
        <a class="navbar-brand" href="../../index.html">mlr <small>v2.19.0.9001</small></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/task.html">Task</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learner.html">Learner</a>
    </li>
    <li>
      <a href="../../articles/tutorial/train.html">Train</a>
    </li>
    <li>
      <a href="../../articles/tutorial/predict.html">Predict</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/preproc.html">Preprocessing</a>
    </li>
    <li>
      <a href="../../articles/tutorial/tune.html">Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/resample.html">Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/benchmark_experiments.html">Benchmarking</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/parallelization.html">Parallelization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/performance.html">Performance</a>
    </li>
    <li>
      <a href="../../articles/tutorial/visualization.html">Visualization</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/usecase_regression.html">Use case - Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/configureMlr.html">mlr Configuration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/wrapper.html">Wrapped Learners</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/impute.html">Imputation</a>
    </li>
    <li>
      <a href="../../articles/tutorial/bagging.html">Generic Bagging</a>
    </li>
    <li>
      <a href="../../articles/tutorial/advanced_tune.html">Advanced Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/feature_selection.html">Feature Selection/Filtering</a>
    </li>
    <li>
      <a href="../../articles/tutorial/nested_resampling.html">Nested Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/over_and_undersampling.html">Imbalanced Classification Problems</a>
    </li>
    <li>
      <a href="../../articles/tutorial/roc_analysis.html">ROC Analysis and Performance Curves</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learning_curve.html">Learning Curve Analysis</a>
    </li>
    <li>
      <a href="../../articles/tutorial/partial_dependence.html">Partial Dependence Plots</a>
    </li>
    <li>
      <a href="../../articles/tutorial/classifier_calibration.html">Classifier Calibration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/hyperpar_tuning_effects.html">Hyperparameter Tuning Effects</a>
    </li>
    <li>
      <a href="../../articles/tutorial/out_of_bag_predictions.html">Out-of-Bag Predictions</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/multilabel.html">Multilabel Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/cost_sensitive_classif.html">Cost-Sensitive Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/handling_of_spatial_data.html">Spatial Data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/functional_data.html">Functional Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extending
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/create_learner.html">Create Custom Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_measure.html">Create Custom Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_imputation.html">Create Custom Imputation Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_filter.html">Create Custom Filters</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendix
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/example_tasks.html">Integrated Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/integrated_learners.html">Integrated Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/measures.html">Integrated Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/filter_methods.html">Integrated Filter Methods</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/mlr_publications.html">mlr Publications</a>
    </li>
    <li>
      <a href="https://github.com/mlr-org/mlr-outreach">Talks, Videos and Workshops</a>
    </li>
    <li class="divider">
    <li>
      <a href="https://mlrmbo.mlr-org.com">mlrMBO</a>
    </li>
    <li>
      <a href="https://https://mlrcpo.mlr-org.com">mlrCPO</a>
    </li>
    <li>
      <a href="https://jakob-r.de/mlrHyperopt/index.html">mlrHyperopt</a>
    </li>
    <li>
      <a href="http://openml.github.io/openml-r/">OpenML</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
        <li>
  <a href="https://github.com/mlr-org/mlr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa-comments"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fab fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right docsearch" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="over_and_undersampling_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Imbalanced Classification Problems</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr/blob/master/vignettes/tutorial/over_and_undersampling.Rmd"><code>vignettes/tutorial/over_and_undersampling.Rmd</code></a></small>
      <div class="hidden name"><code>over_and_undersampling.Rmd</code></div>

    </div>

    
    
<p>In case of <em>binary classification</em> strongly imbalanced classes often lead to unsatisfactory results regarding the prediction of new observations, especially for the small class. In this context <em>imbalanced classes</em> simply means that the number of observations of one class (usu. positive or majority class) by far exceeds the number of observations of the other class (usu. negative or minority class). This setting can be observed fairly often in practice and in various disciplines like credit scoring, fraud detection, medical diagnostics or churn management.</p>
<p>Most classification methods work best when the number of observations per class are roughly equal. The problem with <em>imbalanced classes</em> is that because of the dominance of the majority class classifiers tend to ignore cases of the minority class as noise and therefore predict the majority class far more often. In order to lay more weight on the cases of the minority class, there are numerous correction methods which tackle the <em>imbalanced classification problem</em>. These methods can generally be divided into <em>cost- and sampling-based approaches</em>. Below all methods supported by <code>mlr</code> are introduced.</p>
<div id="sampling-based-approaches" class="section level2">
<h2 class="hasAnchor">
<a href="#sampling-based-approaches" class="anchor"></a>Sampling-based approaches</h2>
<p>The basic idea of <em>sampling methods</em> is to simply adjust the proportion of the classes in order to increase the weight of the minority class observations within the model.</p>
<p>The <em>sampling-based approaches</em> can be divided further into three different categories:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Undersampling methods</strong>: Elimination of randomly chosen cases of the majority class to decrease their effect on the classifier. All cases of the minority class are kept.</p></li>
<li><p><strong>Oversampling methods</strong>: Generation of additional cases (copies, artificial observations) of the minority class to increase their effect on the classifier. All cases of the majority class are kept.</p></li>
<li><p><strong>Hybrid methods</strong>: Mixture of under- and oversampling strategies.</p></li>
</ol>
<p>All these methods directly access the underlying data and “rearrange” it. In this way the sampling is done as part of the <em>preprocesssing</em> and can therefore be combined with every appropriate classifier.</p>
<p><code>mlr</code> currently supports the first two approaches.</p>
<div id="simple-over--and-undersampling" class="section level3">
<h3 class="hasAnchor">
<a href="#simple-over--and-undersampling" class="anchor"></a>(Simple) over- and undersampling</h3>
<p>As mentioned above <em>undersampling</em> always refers to the majority class, while <em>oversampling</em> affects the minority class. By the use of <em>undersampling</em>, randomly chosen observations of the majority class are eliminated. Through (simple) <em>oversampling</em> all observations of the minority class are considered at least once when fitting the model. In addition, exact copies of minority class cases are created by random sampling with repetitions.</p>
<p>First, let’s take a look at the effect for a classification <a href="task.html" target="_blank">task</a>. Based on a simulated <code>ClassifTask</code> (<code><a href="../../reference/Task.html">Task()</a></code>) with imbalanced classes two new tasks (<code>task.over</code>, <code>task.under</code>) are created via <code>mlr</code> functions <code><a href="../../reference/oversample.html">oversample()</a></code> and <code><a href="../../reference/oversample.html">undersample()</a></code>, respectively.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data.imbal.train</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">5000</span>, mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeClassifTask.html">makeClassifTask</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data.imbal.train</span>, target <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span>
<span class="va">task.over</span> <span class="op">=</span> <span class="fu"><a href="../../reference/oversample.html">oversample</a></span><span class="op">(</span><span class="va">task</span>, rate <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>
<span class="va">task.under</span> <span class="op">=</span> <span class="fu"><a href="../../reference/oversample.html">undersample</a></span><span class="op">(</span><span class="va">task</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="../../reference/getTaskTargets.html">getTaskTargets</a></span><span class="op">(</span><span class="va">task</span><span class="op">)</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##    A    B </span>
<span class="co">##  100 5000</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="../../reference/getTaskTargets.html">getTaskTargets</a></span><span class="op">(</span><span class="va">task.over</span><span class="op">)</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##    A    B </span>
<span class="co">##  800 5000</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="../../reference/getTaskTargets.html">getTaskTargets</a></span><span class="op">(</span><span class="va">task.under</span><span class="op">)</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##   A   B </span>
<span class="co">## 100 625</span></code></pre></div>
<p>Please note that the <em>undersampling rate</em> has to be between 0 and 1, where 1 means no undersampling and 0.5 implies a reduction of the majority class size to 50 percent. Correspondingly, the <em>oversampling rate</em> must be greater or equal to 1, where 1 means no oversampling and 2 would result in doubling the minority class size.</p>
<p>As a result the <a href="performance.html" target="_blank">performance</a> should improve if the model is applied to new data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, predict.type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span>
<span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="va">lrn</span>, <span class="va">task</span><span class="op">)</span>
<span class="va">mod.over</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="va">lrn</span>, <span class="va">task.over</span><span class="op">)</span>
<span class="va">mod.under</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="va">lrn</span>, <span class="va">task.under</span><span class="op">)</span>
<span class="va">data.imbal.test</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../../reference/performance.html">performance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span>, newdata <span class="op">=</span> <span class="va">data.imbal.test</span><span class="op">)</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="co">##       mmce        ber        auc </span>
<span class="co">## 0.01960784 0.50000000 0.50000000</span>

<span class="fu"><a href="../../reference/performance.html">performance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod.over</span>, newdata <span class="op">=</span> <span class="va">data.imbal.test</span><span class="op">)</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="co">##       mmce        ber        auc </span>
<span class="co">## 0.04705882 0.41600000 0.69080000</span>

<span class="fu"><a href="../../reference/performance.html">performance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod.under</span>, newdata <span class="op">=</span> <span class="va">data.imbal.test</span><span class="op">)</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="co">##      mmce       ber       auc </span>
<span class="co">## 0.0372549 0.5090000 0.7265000</span></code></pre></div>
<p>In this case the <em>performance measure</em> has to be considered very carefully. As the <em>misclassification rate</em> (<a href="measures.html" target="_blank">mmce</a>) evaluates the overall accuracy of the predictions, the <em>balanced error rate</em> (<a href="measures.html" target="_blank">ber</a>) and <em>area under the ROC Curve</em> (<a href="measures.html" target="_blank">auc</a>) might be more suitable here, as the misclassifications within each class are separately taken into account.</p>
</div>
<div id="over--and-undersampling-wrappers" class="section level3">
<h3 class="hasAnchor">
<a href="#over--and-undersampling-wrappers" class="anchor"></a>Over- and undersampling wrappers</h3>
<p>Alternatively, <code>mlr</code> also offers the integration of over- and undersampling via a <a href="wrapper.html" target="_blank">wrapper approach</a>. This way over- and undersampling can be applied to already <a href="learner.html" target="_blank">existing learners</a> to extend their functionality.</p>
<p>The example given above is repeated once again, but this time with extended learners instead of modified tasks (see <code><a href="../../reference/makeUndersampleWrapper.html">makeOversampleWrapper()</a></code> and <code><a href="../../reference/makeUndersampleWrapper.html">makeUndersampleWrapper()</a></code>). Just like before the <em>undersampling rate</em> has to be between 0 and 1, while the <em>oversampling rate</em> has a lower boundary of 1.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lrn.over</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeUndersampleWrapper.html">makeOversampleWrapper</a></span><span class="op">(</span><span class="va">lrn</span>, osw.rate <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>
<span class="va">lrn.under</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeUndersampleWrapper.html">makeUndersampleWrapper</a></span><span class="op">(</span><span class="va">lrn</span>, usw.rate <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span>
<span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="va">lrn</span>, <span class="va">task</span><span class="op">)</span>
<span class="va">mod.over</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="va">lrn.over</span>, <span class="va">task</span><span class="op">)</span>
<span class="va">mod.under</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="va">lrn.under</span>, <span class="va">task</span><span class="op">)</span>

<span class="fu"><a href="../../reference/performance.html">performance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span>, newdata <span class="op">=</span> <span class="va">data.imbal.test</span><span class="op">)</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="co">##       mmce        ber        auc </span>
<span class="co">## 0.01960784 0.50000000 0.50000000</span>

<span class="fu"><a href="../../reference/performance.html">performance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod.over</span>, newdata <span class="op">=</span> <span class="va">data.imbal.test</span><span class="op">)</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="co">##       mmce        ber        auc </span>
<span class="co">## 0.02941176 0.45600000 0.76880000</span>

<span class="fu"><a href="../../reference/performance.html">performance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod.under</span>, newdata <span class="op">=</span> <span class="va">data.imbal.test</span><span class="op">)</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="co">##       mmce        ber        auc </span>
<span class="co">## 0.03529412 0.31200000 0.79960000</span></code></pre></div>
</div>
<div id="extensions-to-oversampling" class="section level3">
<h3 class="hasAnchor">
<a href="#extensions-to-oversampling" class="anchor"></a>Extensions to oversampling</h3>
<p>Two extensions to (simple) oversampling are available in <code>mlr</code>.</p>
<div id="smote-synthetic-minority-oversampling-technique" class="section level4">
<h4 class="hasAnchor">
<a href="#smote-synthetic-minority-oversampling-technique" class="anchor"></a>1. SMOTE (Synthetic Minority Oversampling Technique)</h4>
<p>As the duplicating of the minority class observations can lead to overfitting, within <em>SMOTE</em> the “new cases” are constructed in a different way. For each new observation, one randomly chosen minority class observation as well as one of its <em>randomly chosen next neighbours</em> are interpolated, so that finally a new <em>artificial observation</em> of the minority class is created. The <code><a href="../../reference/smote.html">smote()</a></code> function in <code>mlr</code> handles numeric as well as factor features, as the gower distance is used for nearest neighbour calculation. The factor level of the new artificial case is sampled from the given levels of the two input observations.</p>
<p>Analogous to oversampling, <em>SMOTE preprocessing</em> is possible via modification of the task.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">task.smote</span> <span class="op">=</span> <span class="fu"><a href="../../reference/smote.html">smote</a></span><span class="op">(</span><span class="va">task</span>, rate <span class="op">=</span> <span class="fl">8</span>, nn <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="../../reference/getTaskTargets.html">getTaskTargets</a></span><span class="op">(</span><span class="va">task</span><span class="op">)</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##    A    B </span>
<span class="co">##  100 5000</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="../../reference/getTaskTargets.html">getTaskTargets</a></span><span class="op">(</span><span class="va">task.smote</span><span class="op">)</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##    A    B </span>
<span class="co">##  800 5000</span></code></pre></div>
<p>Alternatively, a new wrapped learner can be created via <code><a href="../../reference/makeSMOTEWrapper.html">makeSMOTEWrapper()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lrn.smote</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeSMOTEWrapper.html">makeSMOTEWrapper</a></span><span class="op">(</span><span class="va">lrn</span>, sw.rate <span class="op">=</span> <span class="fl">8</span>, sw.nn <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">mod.smote</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="va">lrn.smote</span>, <span class="va">task</span><span class="op">)</span>
<span class="fu"><a href="../../reference/performance.html">performance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod.smote</span>, newdata <span class="op">=</span> <span class="va">data.imbal.test</span><span class="op">)</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="co">##       mmce        ber        auc </span>
<span class="co">## 0.03137255 0.50600000 0.70930000</span></code></pre></div>
<p>By default the number of nearest neighbours considered within the algorithm is set to 5.</p>
</div>
<div id="overbagging" class="section level4">
<h4 class="hasAnchor">
<a href="#overbagging" class="anchor"></a>2. Overbagging</h4>
<p>Another extension of oversampling consists in the combination of sampling with the <a href="bagging.html" target="_blank">bagging approach</a>. For each iteration of the bagging process, minority class observations are oversampled with a given rate in <code>obw.rate</code>. The majority class cases can either all be taken into account for each iteration (<code>obw.maxcl = "all"</code>) or bootstrapped with replacement to increase variability between training data sets during iterations (<code>obw.maxcl = "boot"</code>).</p>
<p>The construction of the <strong>Overbagging Wrapper</strong> works similar to <code><a href="../../reference/makeBaggingWrapper.html">makeBaggingWrapper()</a></code>. First an existing <code>mlr</code> learner has to be passed to <code><a href="../../reference/makeOverBaggingWrapper.html">makeOverBaggingWrapper()</a></code>. The number of iterations or fitted models can be set via <code>obw.iters</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, predict.type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">obw.lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeOverBaggingWrapper.html">makeOverBaggingWrapper</a></span><span class="op">(</span><span class="va">lrn</span>, obw.rate <span class="op">=</span> <span class="fl">8</span>, obw.iters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>For <em>binary classification</em> the prediction is based on majority voting to create a discrete label. Corresponding probabilities are predicted by considering the proportions of all the predicted labels. Please note that the benefit of the sampling process is <em>highly dependent</em> on the specific learner as shown in the following example.</p>
<p>First, let’s take a look at the tree learner with and without overbagging:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setPredictType.html">setPredictType</a></span><span class="op">(</span><span class="va">lrn</span>, <span class="st">"prob"</span><span class="op">)</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">r1</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span>learner <span class="op">=</span> <span class="va">lrn</span>, task <span class="op">=</span> <span class="va">task</span>, resampling <span class="op">=</span> <span class="va">rdesc</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span>,
  measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="va">r1</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">## mmce.test.mean  ber.test.mean  auc.test.mean </span>
<span class="co">##     0.01960784     0.50000000     0.50000000</span>

<span class="va">obw.lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setPredictType.html">setPredictType</a></span><span class="op">(</span><span class="va">obw.lrn</span>, <span class="st">"prob"</span><span class="op">)</span>
<span class="va">r2</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span>learner <span class="op">=</span> <span class="va">obw.lrn</span>, task <span class="op">=</span> <span class="va">task</span>, resampling <span class="op">=</span> <span class="va">rdesc</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span>,
  measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="va">r2</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">## mmce.test.mean  ber.test.mean  auc.test.mean </span>
<span class="co">##      0.0327451      0.4781435      0.5361176</span></code></pre></div>
<p>Now let’s consider a <em>random forest</em> as initial learner:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.ranger"</span><span class="op">)</span>
<span class="va">obw.lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeOverBaggingWrapper.html">makeOverBaggingWrapper</a></span><span class="op">(</span><span class="va">lrn</span>, obw.rate <span class="op">=</span> <span class="fl">8</span>, obw.iters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setPredictType.html">setPredictType</a></span><span class="op">(</span><span class="va">lrn</span>, <span class="st">"prob"</span><span class="op">)</span>
<span class="va">r1</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span>learner <span class="op">=</span> <span class="va">lrn</span>, task <span class="op">=</span> <span class="va">task</span>, resampling <span class="op">=</span> <span class="va">rdesc</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span>,
  measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="va">r1</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">## mmce.test.mean  ber.test.mean  auc.test.mean </span>
<span class="co">##     0.03196078     0.49333337     0.58766687</span>

<span class="va">obw.lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setPredictType.html">setPredictType</a></span><span class="op">(</span><span class="va">obw.lrn</span>, <span class="st">"prob"</span><span class="op">)</span>
<span class="va">r2</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span>learner <span class="op">=</span> <span class="va">obw.lrn</span>, task <span class="op">=</span> <span class="va">task</span>, resampling <span class="op">=</span> <span class="va">rdesc</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span>,
  measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span>, <span class="va">auc</span><span class="op">)</span><span class="op">)</span>
<span class="va">r2</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">## mmce.test.mean  ber.test.mean  auc.test.mean </span>
<span class="co">##     0.04117647     0.49834049     0.49953403</span></code></pre></div>
<p>While <em>overbagging</em> slighty improves the performance of the <em>decision tree</em>, the AUC decreases in the second example when additional overbagging is applied. As RF itself is already a strong learner (and a bagged one as well), a further bagging step isn’t very helpful here and usually won’t improve the model.</p>
</div>
</div>
</div>
<div id="tuning-the-probability-threshold" class="section level2">
<h2 class="hasAnchor">
<a href="#tuning-the-probability-threshold" class="anchor"></a>Tuning the probability threshold</h2>
<p>In binary classification, the default probability value at which a prediction is either classified as “1” or “0” is 0.50. This means with an estimate of &gt;= 0.50 the observation is put into class “1” while lower values get assigned class “0”. To reach a better performance in binary classification, it can be helpful to also optimize the the probability threshold at which this split is made. This can be especially helpful if the response is unbalanced. To enable this, argument <code>tune.threshold</code> needs to be set to <code>TRUE</code> in the chosen <code>makeTuneControl*</code> function.</p>
<pre><code>## Resampling: cross-validation
## Measures:             mmce
## [Resample] iter 1:    0.0541069
## [Resample] iter 2:    0.0606654
## [Resample] iter 3:    0.0475880
## 
## Aggregated Result: mmce.test.mean=0.0541201
## </code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.gbm"</span>, predict.type <span class="op">=</span> <span class="st">"prob"</span>, distribution <span class="op">=</span> <span class="st">"bernoulli"</span><span class="op">)</span>
<span class="va">ps</span> <span class="op">=</span> <span class="fu"><a href="https://paramhelpers.mlr-org.com/reference/makeParamSet.html">makeParamSet</a></span><span class="op">(</span>
  <span class="fu"><a href="https://paramhelpers.mlr-org.com/reference/Param.html">makeIntegerParam</a></span><span class="op">(</span><span class="st">"interaction.depth"</span>, lower <span class="op">=</span> <span class="fl">1</span>, upper <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">ctrl</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeTuneControlRandom.html">makeTuneControlRandom</a></span><span class="op">(</span>maxit <span class="op">=</span> <span class="fl">2</span>, tune.threshold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span><span class="op">(</span><span class="va">lrn</span>, par.set <span class="op">=</span> <span class="va">ps</span>, control <span class="op">=</span> <span class="va">ctrl</span>, resampling <span class="op">=</span> <span class="va">cv2</span><span class="op">)</span>
<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="va">lrn</span>, <span class="va">spam.task</span>, <span class="va">cv3</span>, extract <span class="op">=</span> <span class="va">getTuneResult</span><span class="op">)</span>
<span class="co">## Resampling: cross-validation</span>
<span class="co">## Measures:             mmce</span>
<span class="co">## [Tune] Started tuning learner classif.gbm for parameter set:</span>
<span class="co">##                      Type len Def Constr Req Tunable Trafo</span>
<span class="co">## interaction.depth integer   -   - 1 to 5   -    TRUE     -</span>
<span class="co">## With control class: TuneControlRandom</span>
<span class="co">## Imputation value: 1</span>
<span class="co">## [Tune-x] 1: interaction.depth=5</span>
<span class="co">## [Tune-y] 1: mmce.test.mean=0.0599739; time: 0.1 min</span>
<span class="co">## [Tune-x] 2: interaction.depth=3</span>
<span class="co">## [Tune-y] 2: mmce.test.mean=0.0625815; time: 0.0 min</span>
<span class="co">## [Tune] Result: interaction.depth=5 : mmce.test.mean=0.0599739</span>
<span class="co">## [Resample] iter 1:    0.0482714</span>
<span class="co">## [Tune] Started tuning learner classif.gbm for parameter set:</span>
<span class="co">##                      Type len Def Constr Req Tunable Trafo</span>
<span class="co">## interaction.depth integer   -   - 1 to 5   -    TRUE     -</span>
<span class="co">## With control class: TuneControlRandom</span>
<span class="co">## Imputation value: 1</span>
<span class="co">## [Tune-x] 1: interaction.depth=1</span>
<span class="co">## [Tune-y] 1: mmce.test.mean=0.0652075; time: 0.0 min</span>
<span class="co">## [Tune-x] 2: interaction.depth=3</span>
<span class="co">## [Tune-y] 2: mmce.test.mean=0.0586882; time: 0.0 min</span>
<span class="co">## [Tune] Result: interaction.depth=3 : mmce.test.mean=0.0586882</span>
<span class="co">## [Resample] iter 2:    0.0560626</span>
<span class="co">## [Tune] Started tuning learner classif.gbm for parameter set:</span>
<span class="co">##                      Type len Def Constr Req Tunable Trafo</span>
<span class="co">## interaction.depth integer   -   - 1 to 5   -    TRUE     -</span>
<span class="co">## With control class: TuneControlRandom</span>
<span class="co">## Imputation value: 1</span>
<span class="co">## [Tune-x] 1: interaction.depth=3</span>
<span class="co">## [Tune-y] 1: mmce.test.mean=0.0577155; time: 0.0 min</span>
<span class="co">## [Tune-x] 2: interaction.depth=2</span>
<span class="co">## [Tune-y] 2: mmce.test.mean=0.0606496; time: 0.0 min</span>
<span class="co">## [Tune] Result: interaction.depth=3 : mmce.test.mean=0.0577155</span>
<span class="co">## [Resample] iter 3:    0.0625815</span>
<span class="co">## </span>
<span class="co">## Aggregated Result: mmce.test.mean=0.0556385</span>
<span class="co">## </span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">extract</span><span class="op">)</span>
<span class="co">## [[1]]</span>
<span class="co">## Tune result:</span>
<span class="co">## Op. pars: interaction.depth=5</span>
<span class="co">## Threshold: 0.48</span>
<span class="co">## mmce.test.mean=0.0599739</span>
<span class="co">## </span>
<span class="co">## [[2]]</span>
<span class="co">## Tune result:</span>
<span class="co">## Op. pars: interaction.depth=3</span>
<span class="co">## Threshold: 0.48</span>
<span class="co">## mmce.test.mean=0.0586882</span>
<span class="co">## </span>
<span class="co">## [[3]]</span>
<span class="co">## Tune result:</span>
<span class="co">## Op. pars: interaction.depth=3</span>
<span class="co">## Threshold: 0.52</span>
<span class="co">## mmce.test.mean=0.0577155</span></code></pre></div>
<p>In the above script the tuning is (of course) nested. What happens is: The tuner evaluates a certain learner configuration via (inner) two-fold CV. On these predictions then the optimal threshold is selected, for this learner config (by calling <code><a href="../../reference/tuneThreshold.html">tuneThreshold()</a></code> on the <code>ResamplePrediction</code> object, which was generated in the configuration evaluation). For the optimal learner config, at the end of tuning, we also know its selected threshold. The model is then trained on the complete outer training data set with the threshold set from the tuning and the prediction is made on the outer test set.</p>
</div>
<div id="cost-based-approaches" class="section level2">
<h2 class="hasAnchor">
<a href="#cost-based-approaches" class="anchor"></a>Cost-based approaches</h2>
<p>In contrast to sampling, <em>cost-based approaches</em> usually require particular learners, which can deal with different <em>class-dependent costs</em> <a href="cost_sensitive_classif.html" target="_blank">Cost-Sensitive Classification</a>.</p>
<div id="weighted-classes-wrapper" class="section level3">
<h3 class="hasAnchor">
<a href="#weighted-classes-wrapper" class="anchor"></a>Weighted classes wrapper</h3>
<p>Another approach independent of the underlying classifier is to assign the costs as <em>class weights</em>, so that each observation receives a weight, depending on the class it belongs to. Similar to the sampling-based approaches, the effect of the minority class observations is thereby increased simply by a higher weight of these instances and vice versa for majority class observations.</p>
<p>In this way every learner which supports weights can be extended through the <a href="wrapper.html" target="_blank">wrapper approach</a>. If the learner does not have a direct parameter for class weights, but supports observation weights, the weights depending on the class are internally set in the wrapper.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.logreg"</span><span class="op">)</span>
<span class="va">wcw.lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeWeightedClassesWrapper.html">makeWeightedClassesWrapper</a></span><span class="op">(</span><span class="va">lrn</span>, wcw.weight <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
<p>For binary classification, the single number passed to the classifier corresponds to the weight of the positive / majority class, while the negative / minority class receives a weight of 1. So actually, no real costs are used within this approach, but the cost ratio is taken into account.</p>
<p>If the underlying learner already has a parameter for class weighting (e.g., <code>class.weights</code> in <code>"classif.ksvm"</code>), the <code>wcw.weight</code> is basically passed to the specific class weighting parameter.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.ksvm"</span><span class="op">)</span>
<span class="va">wcw.lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeWeightedClassesWrapper.html">makeWeightedClassesWrapper</a></span><span class="op">(</span><span class="va">lrn</span>, wcw.weight <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bernd Bischl, Michel Lang, Lars Kotthoff, Patrick Schratz, Julia Schiffner, Jakob Richter, Zachary Jones, Giuseppe Casalicchio, Mason Gallo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'e300ecafdf04fe1199e3339c825ce7d0',
    indexName: 'mlr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
