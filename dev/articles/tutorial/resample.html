<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Resampling • mlr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<link href="../../extra.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Resampling">
<meta property="og:description" content="mlr">
<meta property="og:image" content="https://mlr.mlr-org.com/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://mlr-org.com"><img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" id="hexlogo" alt="mlr-org"></a>
        <a class="navbar-brand" href="../../index.html">mlr <small>v2.19.0.9001</small></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/task.html">Task</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learner.html">Learner</a>
    </li>
    <li>
      <a href="../../articles/tutorial/train.html">Train</a>
    </li>
    <li>
      <a href="../../articles/tutorial/predict.html">Predict</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/preproc.html">Preprocessing</a>
    </li>
    <li>
      <a href="../../articles/tutorial/tune.html">Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/resample.html">Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/benchmark_experiments.html">Benchmarking</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/parallelization.html">Parallelization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/performance.html">Performance</a>
    </li>
    <li>
      <a href="../../articles/tutorial/visualization.html">Visualization</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/usecase_regression.html">Use case - Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/configureMlr.html">mlr Configuration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/wrapper.html">Wrapped Learners</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/impute.html">Imputation</a>
    </li>
    <li>
      <a href="../../articles/tutorial/bagging.html">Generic Bagging</a>
    </li>
    <li>
      <a href="../../articles/tutorial/advanced_tune.html">Advanced Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/feature_selection.html">Feature Selection/Filtering</a>
    </li>
    <li>
      <a href="../../articles/tutorial/nested_resampling.html">Nested Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/over_and_undersampling.html">Imbalanced Classification Problems</a>
    </li>
    <li>
      <a href="../../articles/tutorial/roc_analysis.html">ROC Analysis and Performance Curves</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learning_curve.html">Learning Curve Analysis</a>
    </li>
    <li>
      <a href="../../articles/tutorial/partial_dependence.html">Partial Dependence Plots</a>
    </li>
    <li>
      <a href="../../articles/tutorial/classifier_calibration.html">Classifier Calibration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/hyperpar_tuning_effects.html">Hyperparameter Tuning Effects</a>
    </li>
    <li>
      <a href="../../articles/tutorial/out_of_bag_predictions.html">Out-of-Bag Predictions</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/multilabel.html">Multilabel Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/cost_sensitive_classif.html">Cost-Sensitive Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/handling_of_spatial_data.html">Spatial Data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/functional_data.html">Functional Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extending
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/create_learner.html">Create Custom Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_measure.html">Create Custom Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_imputation.html">Create Custom Imputation Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_filter.html">Create Custom Filters</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendix
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/example_tasks.html">Integrated Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/integrated_learners.html">Integrated Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/measures.html">Integrated Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/filter_methods.html">Integrated Filter Methods</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/mlr_publications.html">mlr Publications</a>
    </li>
    <li>
      <a href="https://github.com/mlr-org/mlr-outreach">Talks, Videos and Workshops</a>
    </li>
    <li class="divider">
    <li>
      <a href="https://mlrmbo.mlr-org.com">mlrMBO</a>
    </li>
    <li>
      <a href="https://https://mlrcpo.mlr-org.com">mlrCPO</a>
    </li>
    <li>
      <a href="https://jakob-r.de/mlrHyperopt/index.html">mlrHyperopt</a>
    </li>
    <li>
      <a href="http://openml.github.io/openml-r/">OpenML</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
        <li>
  <a href="https://github.com/mlr-org/mlr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa-comments"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fab fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right docsearch" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="resample_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Resampling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr/blob/master/vignettes/tutorial/resample.Rmd"><code>vignettes/tutorial/resample.Rmd</code></a></small>
      <div class="hidden name"><code>resample.Rmd</code></div>

    </div>

    
    
<p>Resampling strategies are usually used to assess the performance of a learning algorithm: The entire data set is (repeatedly) split into training sets <span class="math inline">\(D^{*b}\)</span> and test sets <span class="math inline">\(D \setminus D^{*b}\)</span>, <span class="math inline">\(b = 1,\ldots,B\)</span>. The learner is trained on each training set, predictions are made on the corresponding test set (sometimes on the training set as well) and the performance measure <span class="math inline">\(S(D^{*b}, D \setminus D^{*b})\)</span> is calculated. Then the <span class="math inline">\(B\)</span> individual performance values are aggregated, most often by calculating the mean. There exist various different resampling strategies, for example cross-validation and bootstrap, to mention just two popular approaches.</p>
<div class="figure" style="text-align: center">
<img src="../pdf/img/resampling.png" alt="Resampling Figure" width="600px"><p class="caption">
Resampling Figure
</p>
</div>
<p>If you want to read up on further details, the paper <a href="http://link.springer.com/chapter/10.1007%2F978-0-387-47509-7_8">Resampling Strategies for Model Assessment and Selection</a> by Simon is probably not a bad choice. Bernd has also published a paper <a href="http://www.mitpressjournals.org/doi/pdf/10.1162/EVCO_a_00069">Resampling methods for meta-model validation with recommendations for evolutionary computation</a> which contains detailed descriptions and lots of statistical background information on resampling methods.</p>
<div id="defining-the-resampling-strategy" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-the-resampling-strategy" class="anchor"></a>Defining the resampling strategy</h2>
<p>In <code>mlr</code> the resampling strategy can be defined via function <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>. It requires a string that specifies the resampling method and, depending on the selected strategy, further information like the number of iterations. The supported resampling strategies are:</p>
<ul>
<li>Cross-validation (<code>"CV"</code>),</li>
<li>Leave-one-out cross-validation (<code>"LOO"</code>),</li>
<li>Repeated cross-validation (<code>"RepCV"</code>),</li>
<li>Out-of-bag bootstrap and other variants like <em>b632</em> (<code>"Bootstrap"</code>),</li>
<li>Subsampling, also called Monte-Carlo cross-validation (<code>"Subsample"</code>),</li>
<li>Holdout (training/test) (<code>"Holdout"</code>).</li>
</ul>
<p>For example if you want to use 3-fold cross-validation type:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 3-fold cross-validation</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">rdesc</span>
<span class="co">## Resample description: cross-validation with 3 iterations.</span>
<span class="co">## Predict: test</span>
<span class="co">## Stratification: FALSE</span></code></pre></div>
<p>For holdout estimation use:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Holdout estimation</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"Holdout"</span><span class="op">)</span>
<span class="va">rdesc</span>
<span class="co">## Resample description: holdout with 0.67 split rate.</span>
<span class="co">## Predict: test</span>
<span class="co">## Stratification: FALSE</span></code></pre></div>
<p>In order to save you some typing <code>mlr</code> contains some pre-defined resample descriptions for very common strategies like holdout (<code>hout</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)) as well as cross-validation with different numbers of folds (e.g., <code>cv5</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) or <code>cv10</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hout</span>
<span class="co">## Resample description: holdout with 0.67 split rate.</span>
<span class="co">## Predict: test</span>
<span class="co">## Stratification: FALSE</span>

<span class="va">cv3</span>
<span class="co">## Resample description: cross-validation with 3 iterations.</span>
<span class="co">## Predict: test</span>
<span class="co">## Stratification: FALSE</span></code></pre></div>
</div>
<div id="performing-the-resampling" class="section level2">
<h2 class="hasAnchor">
<a href="#performing-the-resampling" class="anchor"></a>Performing the resampling</h2>
<p>Function <code><a href="../../reference/resample.html">resample()</a></code> evaluates a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) on a given machine learning <code><a href="../../reference/Task.html">Task()</a></code> using the selected resampling strategy (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>).</p>
<p>As a first example, the performance of linear regression (<code><a href="https://rdrr.io/r/stats/lm.html">stats::lm()</a></code>) on the <code>BostonHousing</code> (<code><a href="https://rdrr.io/pkg/mlbench/man/BostonHousing.html">mlbench::BostonHousing()</a></code>) data set is calculated using <em>3-fold cross-validation</em>.</p>
<p>Generally, for <em><span class="math inline">\(K\)</span>-fold cross-validation</em> the data set <span class="math inline">\(D\)</span> is partitioned into <span class="math inline">\(K\)</span> subsets of (approximately) equal size. In the <span class="math inline">\(b\)</span>-th of the <span class="math inline">\(K\)</span> iterations, the <span class="math inline">\(b\)</span>-th subset is used for testing, while the union of the remaining parts forms the training set.</p>
<p>As usual, you can either pass a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) object to <code><a href="../../reference/resample.html">resample()</a></code> or, as done here, provide the class name <code>"regr.lm"</code> of the learner. Since no performance measure is specified the default for regression learners (mean squared error, <a href="measures.html" target="_blank">mse</a>) is calculated.</p>
<pre><code>## Resampling: cross-validation
## Measures:             mse
## [Resample] iter 1:    19.8630628
## [Resample] iter 2:    29.4831894
## [Resample] iter 3:    21.2694775
## 
## Aggregated Result: mse.test.mean=23.5385766
## </code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Specify the resampling strategy (3-fold cross-validation)</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="co"># Calculate the performance</span>
<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"regr.lm"</span>, <span class="va">bh.task</span>, <span class="va">rdesc</span><span class="op">)</span>
<span class="co">## Resampling: cross-validation</span>
<span class="co">## Measures:             mse</span>
<span class="co">## [Resample] iter 1:    25.1371739</span>
<span class="co">## [Resample] iter 2:    23.1279497</span>
<span class="co">## [Resample] iter 3:    21.9152672</span>
<span class="co">##</span>
<span class="co">## Aggregated Result: mse.test.mean=23.3934636</span>
<span class="co">##</span>

<span class="va">r</span>
<span class="co">## Resample Result</span>
<span class="co">## Task: BostonHousing-example</span>
<span class="co">## Learner: regr.lm</span>
<span class="co">## Aggr perf: mse.test.mean=23.3934636</span>
<span class="co">## Runtime: 0.0375051</span></code></pre></div>
<p>The result <code>r</code> is an object of class <code><a href="../../reference/resample.html">resample()</a></code> result. It contains performance results for the learner and some additional information like the runtime, predicted values, and optionally the models fitted in single resampling iterations.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Peak into r</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>
<span class="co">##  [1] "learner.id"     "task.id"        "task.desc"      "measures.train"</span>
<span class="co">##  [5] "measures.test"  "aggr"           "pred"           "models"        </span>
<span class="co">##  [9] "err.msgs"       "err.dumps"      "extract"        "runtime"</span>

<span class="va">r</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">## mse.test.mean </span>
<span class="co">##      23.53858</span>

<span class="va">r</span><span class="op">$</span><span class="va">measures.test</span>
<span class="co">##   iter      mse</span>
<span class="co">## 1    1 19.86306</span>
<span class="co">## 2    2 29.48319</span>
<span class="co">## 3    3 21.26948</span></code></pre></div>
<p><code>r$measures.test</code> gives the performance on each of the 3 test data sets. <code>r$aggr</code> shows the aggregated performance value. Its name <code>"mse.test.mean"</code> indicates the performance measure, <a href="measures.html" target="_blank">mse</a>, and the method, <code>test.mean</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>), used to aggregate the 3 individual performances. <code>test.mean</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>) is the default aggregation scheme for most performance measures and, as the name implies, takes the mean over the performances on the test data sets.</p>
<p>Resampling in <code>mlr</code> works the same way for all types of learning problems and learners. Below is a classification example where a classification tree (rpart) (<code><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart::rpart()</a></code>) is evaluated on the <code>Sonar</code> (<code>mlbench::sonar()</code>) data set by subsampling with 5 iterations.</p>
<p>In each subsampling iteration the data set <span class="math inline">\(D\)</span> is randomly partitioned into a training and a test set according to a given percentage, e.g., 2/3 training and 1/3 test set. If there is just one iteration, the strategy is commonly called <em>holdout</em> or <em>test sample estimation</em>.</p>
<p>You can calculate several measures at once by passing a <code>list</code> of Measures (<code><a href="../../reference/makeMeasure.html">makeMeasure()</a></code>)s to <code><a href="../../reference/resample.html">resample()</a></code>. Below, the error rate (<a href="measures.html" target="_blank">mmce</a>), false positive and false negative rates (<a href="measures.html" target="_blank">fpr</a>, <a href="measures.html" target="_blank">fnr</a>), and the time it takes to train the learner (<a href="measures.html" target="_blank">timetrain</a>) are estimated by <em>subsampling</em> with 5 iterations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Subsampling with 5 iterations and default split ratio 2/3</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"Subsample"</span>, iters <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="co"># Subsampling with 5 iterations and 4/5 training data</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"Subsample"</span>, iters <span class="op">=</span> <span class="fl">5</span>, split <span class="op">=</span> <span class="fl">4</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>

<span class="co"># Classification tree with information splitting criterion</span>
<span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>split <span class="op">=</span> <span class="st">"information"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Calculate the performance measures</span>
<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="va">lrn</span>, <span class="va">sonar.task</span>, <span class="va">rdesc</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">fpr</span>, <span class="va">fnr</span>, <span class="va">timetrain</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Resampling: subsampling</span>
<span class="co">## Measures:             mmce        fpr         fnr         timetrain</span>
<span class="co">## [Resample] iter 1:    0.4047619   0.5416667   0.2222222   0.0110000</span>
<span class="co">## [Resample] iter 2:    0.1666667   0.1200000   0.2352941   0.0070000</span>
<span class="co">## [Resample] iter 3:    0.3333333   0.1333333   0.4444444   0.0100000</span>
<span class="co">## [Resample] iter 4:    0.2380952   0.3913043   0.0526316   0.0280000</span>
<span class="co">## [Resample] iter 5:    0.3095238   0.2800000   0.3529412   0.0080000</span>
<span class="co">##</span>
<span class="co">## Aggregated Result: mmce.test.mean=0.2904762,fpr.test.mean=0.2932609,fnr.test.mean=0.2615067,timetrain.test.mean=0.0128000</span>
<span class="co">##</span>

<span class="va">r</span>
<span class="co">## Resample Result</span>
<span class="co">## Task: Sonar-example</span>
<span class="co">## Learner: classif.rpart</span>
<span class="co">## Aggr perf: mmce.test.mean=0.2904762,fpr.test.mean=0.2932609,fnr.test.mean=0.2615067,timetrain.test.mean=0.0128000</span>
<span class="co">## Runtime: 0.10692</span></code></pre></div>
<p>If you want to add further measures afterwards, use <code><a href="../../reference/addRRMeasure.html">addRRMeasure()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add balanced error rate (ber) and time used to predict</span>
<span class="fu"><a href="../../reference/addRRMeasure.html">addRRMeasure</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ber</span>, <span class="va">timepredict</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Resample Result</span>
<span class="co">## Task: Sonar-example</span>
<span class="co">## Learner: classif.rpart</span>
<span class="co">## Aggr perf: mmce.test.mean=0.2904762,fpr.test.mean=0.2932609,fnr.test.mean=0.2615067,timetrain.test.mean=0.0128000,ber.test.mean=0.2773838,timepredict.test.mean=0.0032000</span>
<span class="co">## Runtime: 0.10692</span></code></pre></div>
<p>By default, <code><a href="../../reference/resample.html">resample()</a></code> prints progress messages and intermediate results. You can turn this off by setting <code>show.info = FALSE</code>, as done in the code chunk below. (If you are interested in suppressing these messages permanently have a look at the tutorial page about <a href="configureMlr.html" target="_blank">configuring mlr</a>.)</p>
<p>In the above example, the Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) was explicitly constructed. For convenience you can also specify the learner as a string and pass any learner parameters via the <code>...</code> argument of <code><a href="../../reference/resample.html">resample()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>split <span class="op">=</span> <span class="st">"information"</span><span class="op">)</span>, <span class="va">sonar.task</span>, <span class="va">rdesc</span>,
  measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">fpr</span>, <span class="va">fnr</span>, <span class="va">timetrain</span><span class="op">)</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">r</span>

<span class="co">## Resample Result</span>
<span class="co">## Task: Sonar-example</span>
<span class="co">## Learner: classif.rpart</span>
<span class="co">## Aggr perf: mmce.test.mean=0.2428571,fpr.test.mean=0.2968173,fnr.test.mean=0.1970195,timetrain.test.mean=0.0084000</span>
<span class="co">## Runtime: 0.0791025</span></code></pre></div>
</div>
<div id="accessing-resample-results" class="section level2">
<h2 class="hasAnchor">
<a href="#accessing-resample-results" class="anchor"></a>Accessing resample results</h2>
<p>Apart from the learner performance you can extract further information from the resample results, for example predicted values or the models fitted in individual resample iterations.</p>
<div id="predictions" class="section level3">
<h3 class="hasAnchor">
<a href="#predictions" class="anchor"></a>Predictions</h3>
<p>Per default, the <code><a href="../../reference/resample.html">resample()</a></code> result contains the predictions made during the resampling. If you do not want to keep them, e.g., in order to conserve memory, set <code>keep.pred = FALSE</code> when calling <code><a href="../../reference/resample.html">resample()</a></code>.</p>
<p>The predictions are stored in slot <code>$pred</code> of the resampling result, which can also be accessed by function <code><a href="../../reference/getRRPredictions.html">getRRPredictions()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r</span><span class="op">$</span><span class="va">pred</span>
<span class="co">## Resampled Prediction for:</span>
<span class="co">## Resample description: subsampling with 5 iterations and 0.80 split rate.</span>
<span class="co">## Predict: test</span>
<span class="co">## Stratification: FALSE</span>
<span class="co">## predict.type: response</span>
<span class="co">## threshold:</span>
<span class="co">## time (mean): 0.00</span>
<span class="co">##    id truth response iter  set</span>
<span class="co">## 1  18     R        M    1 test</span>
<span class="co">## 2 189     M        M    1 test</span>
<span class="co">## 3  88     R        R    1 test</span>
<span class="co">## 4 121     M        R    1 test</span>
<span class="co">## 5 165     M        R    1 test</span>
<span class="co">## 6 111     M        M    1 test</span>
<span class="co">## ... (#rows: 210, #cols: 5)</span>

<span class="va">pred</span> <span class="op">=</span> <span class="fu"><a href="../../reference/getRRPredictions.html">getRRPredictions</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>
<span class="va">pred</span>
<span class="co">## Resampled Prediction for:</span>
<span class="co">## Resample description: subsampling with 5 iterations and 0.80 split rate.</span>
<span class="co">## Predict: test</span>
<span class="co">## Stratification: FALSE</span>
<span class="co">## predict.type: response</span>
<span class="co">## threshold:</span>
<span class="co">## time (mean): 0.00</span>
<span class="co">##    id truth response iter  set</span>
<span class="co">## 1  18     R        M    1 test</span>
<span class="co">## 2 189     M        M    1 test</span>
<span class="co">## 3  88     R        R    1 test</span>
<span class="co">## 4 121     M        R    1 test</span>
<span class="co">## 5 165     M        R    1 test</span>
<span class="co">## 6 111     M        M    1 test</span>
<span class="co">## ... (#rows: 210, #cols: 5)</span></code></pre></div>
<p><code>pred</code> is an object of class <code><a href="../../reference/resample.html">resample()</a></code> Prediction. Just as a <code><a href="../../reference/Prediction.html">Prediction()</a></code> object (see the tutorial page on making <a href="predict.html" target="_blank">predictions</a> it has an element <code>$data</code> which is a <code>data.frame</code> that contains the predictions and in the case of a supervised learning problem the true values of the target variable(s). You can use <code>as.data.frame</code> (<code><a href="../../reference/Prediction.html">Prediction()</a></code> to directly access the <code>$data</code> slot. Moreover, all getter functions for <code><a href="../../reference/Prediction.html">Prediction()</a></code> objects like <code><a href="../../reference/getPredictionResponse.html">getPredictionResponse()</a></code> or <code><a href="../../reference/getPredictionProbabilities.html">getPredictionProbabilities()</a></code> are applicable.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span>
<span class="co">##    id truth response iter  set</span>
<span class="co">## 1  66     R        R    1 test</span>
<span class="co">## 2 170     M        M    1 test</span>
<span class="co">## 3  90     R        M    1 test</span>
<span class="co">## 4  26     R        R    1 test</span>
<span class="co">## 5 187     M        R    1 test</span>
<span class="co">## 6  89     R        M    1 test</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../../reference/getPredictionResponse.html">getPredictionTruth</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [1] R M R R M R</span>
<span class="co">## Levels: M R</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../../reference/getPredictionResponse.html">getPredictionResponse</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [1] R M M R R M</span>
<span class="co">## Levels: M R</span></code></pre></div>
<p>The columns <code>iter</code> and <code>set</code> in the <code>data.frame</code> indicate the resampling iteration and the data set (<code>train</code> or <code>test</code>) for which the prediction was made.</p>
<p>By default, predictions are made for the test sets only. If predictions for the training set are required, set <code>predict = "train"</code> (for predictions on the train set only) or <code>predict = "both"</code> (for predictions on both train and test sets) in <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>. In any case, this is necessary for some bootstrap methods (<em>b632</em> and <em>b632+</em>) and some examples are shown later on.</p>
<p>Below, we use simple Holdout, i.e., split the data once into a training and test set, as resampling strategy and make predictions on both sets.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Make predictions on both training and test sets</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"Holdout"</span>, predict <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span>

<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"classif.lda"</span>, <span class="va">iris.task</span>, <span class="va">rdesc</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">r</span>
<span class="co">## Resample Result</span>
<span class="co">## Task: iris-example</span>
<span class="co">## Learner: classif.lda</span>
<span class="co">## Aggr perf: mmce.test.mean=0.0200000</span>
<span class="co">## Runtime: 0.00993848</span>

<span class="va">r</span><span class="op">$</span><span class="va">measures.train</span>
<span class="co">##   iter mmce</span>
<span class="co">## 1    1 0.02</span></code></pre></div>
<p>(Please note that nonetheless the misclassification rate <code>r$aggr</code> is estimated on the test data only. How to calculate performance measures on the training sets is shown below.)</p>
<p>A second function to extract predictions from resample results is <code><a href="../../reference/getRRPredictionList.html">getRRPredictionList()</a></code> which returns a <code>list</code> of predictions split by data set (train/test) and resampling iteration.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predList</span> <span class="op">=</span> <span class="fu"><a href="../../reference/getRRPredictionList.html">getRRPredictionList</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>
<span class="va">predList</span>
<span class="co">## $train</span>
<span class="co">## $train$`1`</span>
<span class="co">## Prediction: 100 observations</span>
<span class="co">## predict.type: response</span>
<span class="co">## threshold:</span>
<span class="co">## time: 0.00</span>
<span class="co">##      id      truth   response</span>
<span class="co">## 96   96 versicolor versicolor</span>
<span class="co">## 130 130  virginica  virginica</span>
<span class="co">## 120 120  virginica  virginica</span>
<span class="co">## 77   77 versicolor versicolor</span>
<span class="co">## 23   23     setosa     setosa</span>
<span class="co">## 59   59 versicolor versicolor</span>
<span class="co">## ... (#rows: 100, #cols: 3)</span>
<span class="co">##</span>
<span class="co">##</span>
<span class="co">## $test</span>
<span class="co">## $test$`1`</span>
<span class="co">## Prediction: 50 observations</span>
<span class="co">## predict.type: response</span>
<span class="co">## threshold:</span>
<span class="co">## time: 0.00</span>
<span class="co">##      id      truth   response</span>
<span class="co">## 92   92 versicolor versicolor</span>
<span class="co">## 58   58 versicolor versicolor</span>
<span class="co">## 48   48     setosa     setosa</span>
<span class="co">## 103 103  virginica  virginica</span>
<span class="co">## 70   70 versicolor versicolor</span>
<span class="co">## 82   82 versicolor versicolor</span>
<span class="co">## ... (#rows: 50, #cols: 3)</span></code></pre></div>
</div>
<div id="learner-models" class="section level3">
<h3 class="hasAnchor">
<a href="#learner-models" class="anchor"></a>Learner models</h3>
<p>In each resampling iteration a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) is fitted on the respective training set. By default, the resulting <code>WrappedModel</code> (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>)s are not included in the <code><a href="../../reference/resample.html">resample()</a></code> result and slot <code>$models</code> is empty. In order to keep them, set <code>models = TRUE</code> when calling <code><a href="../../reference/resample.html">resample()</a></code>, as in the following survival analysis example.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 3-fold cross-validation</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"surv.coxph"</span>, <span class="va">lung.task</span>, <span class="va">rdesc</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span>, models <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">r</span><span class="op">$</span><span class="va">models</span>
<span class="co">## [[1]]</span>
<span class="co">## Model for learner.id=surv.coxph; learner.class=surv.coxph</span>
<span class="co">## Trained on: task.id = lung-example; obs = 111; features = 8</span>
<span class="co">## Hyperparameters: </span>
<span class="co">## </span>
<span class="co">## [[2]]</span>
<span class="co">## Model for learner.id=surv.coxph; learner.class=surv.coxph</span>
<span class="co">## Trained on: task.id = lung-example; obs = 111; features = 8</span>
<span class="co">## Hyperparameters: </span>
<span class="co">## </span>
<span class="co">## [[3]]</span>
<span class="co">## Model for learner.id=surv.coxph; learner.class=surv.coxph</span>
<span class="co">## Trained on: task.id = lung-example; obs = 112; features = 8</span>
<span class="co">## Hyperparameters:</span></code></pre></div>
</div>
<div id="the-extract-option" class="section level3">
<h3 class="hasAnchor">
<a href="#the-extract-option" class="anchor"></a>The extract option</h3>
<p>Keeping complete fitted models can be memory-intensive if these objects are large or the number of resampling iterations is high. Alternatively, you can use the <code>extract</code> argument of <code><a href="../../reference/resample.html">resample()</a></code> to retain only the information you need. To this end you need to pass a function to <code>extract</code> which is applied to each <code>WrappedModel</code> (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>) object fitted in each resampling iteration.</p>
<p>Below, we cluster the <code><a href="https://rdrr.io/r/datasets/mtcars.html">datasets::mtcars()</a></code> data using the <span class="math inline">\(k\)</span>-means algorithm with <span class="math inline">\(k = 3\)</span> and keep only the cluster centers.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 3-fold cross-validation</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="co"># Extract the compute cluster centers</span>
<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"cluster.kmeans"</span>, <span class="va">mtcars.task</span>, <span class="va">rdesc</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span>,
  centers <span class="op">=</span> <span class="fl">3</span>, extract <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../../reference/getLearnerModel.html">getLearnerModel</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span>
<span class="va">r</span><span class="op">$</span><span class="va">extract</span>
<span class="co">## [[1]]</span>
<span class="co">##        mpg cyl     disp        hp     drat       wt     qsec        vs</span>
<span class="co">## 1 26.45556   4 107.7556  83.33333 4.094444 2.291444 19.15889 0.8888889</span>
<span class="co">## 2 14.94444   8 338.2889 208.33333 3.178889 3.894889 16.69889 0.0000000</span>
<span class="co">## 3 19.57500   6 202.6500 112.00000 3.415000 3.247500 18.89500 0.7500000</span>
<span class="co">##          am     gear     carb</span>
<span class="co">## 1 0.6666667 4.111111 1.666667</span>
<span class="co">## 2 0.1111111 3.222222 3.555556</span>
<span class="co">## 3 0.2500000 3.500000 2.500000</span>
<span class="co">## </span>
<span class="co">## [[2]]</span>
<span class="co">##        mpg      cyl      disp       hp     drat     wt     qsec        vs</span>
<span class="co">## 1 18.32857 6.571429 202.40000 142.2857 3.465714 3.3200 17.85429 0.4285714</span>
<span class="co">## 2 26.73333 4.000000  96.96667  77.5000 4.178333 2.1125 18.70167 0.8333333</span>
<span class="co">## 3 14.96250 8.000000 387.75000 218.6250 3.238750 4.1955 16.65750 0.0000000</span>
<span class="co">##          am     gear     carb</span>
<span class="co">## 1 0.2857143 3.714286 3.571429</span>
<span class="co">## 2 0.8333333 4.000000 1.333333</span>
<span class="co">## 3 0.2500000 3.500000 3.750000</span>
<span class="co">## </span>
<span class="co">## [[3]]</span>
<span class="co">##        mpg cyl     disp        hp     drat       wt     qsec  vs        am</span>
<span class="co">## 1 20.46000   6 178.1200 125.60000 3.684000 2.984000 17.34400 0.4 0.6000000</span>
<span class="co">## 2 26.87143   4 108.7714  86.14286 3.948571 2.426857 19.48286 1.0 0.7142857</span>
<span class="co">## 3 15.12222   8 354.2889 208.22222 3.306667 3.983333 16.71889 0.0 0.1111111</span>
<span class="co">##       gear     carb</span>
<span class="co">## 1 4.000000 3.800000</span>
<span class="co">## 2 4.142857 1.571429</span>
<span class="co">## 3 3.222222 3.333333</span></code></pre></div>
<p>As a second example, we extract the variable importances from fitted regression trees using function <code><a href="../../reference/getFeatureImportance.html">getFeatureImportance()</a></code>. (For more detailed information on this topic see the <a href="feature_selection.html" target="_blank">feature selection</a> page.)</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extract the variable importance in a regression tree</span>
<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"regr.rpart"</span>, <span class="va">bh.task</span>, <span class="va">rdesc</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span>, extract <span class="op">=</span> <span class="va">getFeatureImportance</span><span class="op">)</span>
<span class="va">r</span><span class="op">$</span><span class="va">extract</span>
<span class="co">## [[1]]</span>
<span class="co">## FeatureImportance:</span>
<span class="co">## Task: BostonHousing-example</span>
<span class="co">## </span>
<span class="co">## Learner: regr.rpart</span>
<span class="co">## Measure: NA</span>
<span class="co">## Contrast: NA</span>
<span class="co">## Aggregation: function (x)  x</span>
<span class="co">## Replace: NA</span>
<span class="co">## Number of Monte-Carlo iterations: NA</span>
<span class="co">## Local: FALSE</span>
<span class="co">## # A tibble: 6 × 2</span>
<span class="co">##   variable importance</span>
<span class="co">##   &lt;chr&gt;         &lt;dbl&gt;</span>
<span class="co">## 1 crim          3102.</span>
<span class="co">## 2 zn            1442.</span>
<span class="co">## 3 indus         4513.</span>
<span class="co">## 4 chas           407.</span>
<span class="co">## 5 nox           4080.</span>
<span class="co">## 6 rm           17791.</span>
<span class="co">## </span>
<span class="co">## [[2]]</span>
<span class="co">## FeatureImportance:</span>
<span class="co">## Task: BostonHousing-example</span>
<span class="co">## </span>
<span class="co">## Learner: regr.rpart</span>
<span class="co">## Measure: NA</span>
<span class="co">## Contrast: NA</span>
<span class="co">## Aggregation: function (x)  x</span>
<span class="co">## Replace: NA</span>
<span class="co">## Number of Monte-Carlo iterations: NA</span>
<span class="co">## Local: FALSE</span>
<span class="co">## # A tibble: 6 × 2</span>
<span class="co">##   variable importance</span>
<span class="co">##   &lt;chr&gt;         &lt;dbl&gt;</span>
<span class="co">## 1 crim          3456.</span>
<span class="co">## 2 zn            1220.</span>
<span class="co">## 3 indus         3973.</span>
<span class="co">## 4 chas           193.</span>
<span class="co">## 5 nox           2218.</span>
<span class="co">## 6 rm           15578.</span>
<span class="co">## </span>
<span class="co">## [[3]]</span>
<span class="co">## FeatureImportance:</span>
<span class="co">## Task: BostonHousing-example</span>
<span class="co">## </span>
<span class="co">## Learner: regr.rpart</span>
<span class="co">## Measure: NA</span>
<span class="co">## Contrast: NA</span>
<span class="co">## Aggregation: function (x)  x</span>
<span class="co">## Replace: NA</span>
<span class="co">## Number of Monte-Carlo iterations: NA</span>
<span class="co">## Local: FALSE</span>
<span class="co">## # A tibble: 6 × 2</span>
<span class="co">##   variable importance</span>
<span class="co">##   &lt;chr&gt;         &lt;dbl&gt;</span>
<span class="co">## 1 crim          5432.</span>
<span class="co">## 2 zn            2233.</span>
<span class="co">## 3 indus         4145.</span>
<span class="co">## 4 chas             0 </span>
<span class="co">## 5 nox           3114.</span>
<span class="co">## 6 rm            8294.</span></code></pre></div>
<p>There is also an convenience function <code><a href="../../reference/getResamplingIndices.html">getResamplingIndices()</a></code> to extract the resampling indices from the <code>ResampleResult</code> object:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/getResamplingIndices.html">getResamplingIndices</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>
<span class="co">## $train.inds</span>
<span class="co">## $train.inds[[1]]</span>
<span class="co">##   [1] 366 235  79 466 361  88  16 346 218 438 444 397  55 456 327 226  38 172</span>
<span class="co">##  [19] 252 500 450 464 149 136  71  47 423 208 203 462 205 116 350 129 261 243</span>
<span class="co">##  [37] 490 241 406 430 340 420  10 277 100 190  26 188 437 130 282 225 328 317</span>
<span class="co">##  [55]  95  51 398 237 285 146  24 238 223   5 152 300 232 151 169 383 470  42</span>
<span class="co">##  [73]  83 322 179 198 162 103 220 382 202 240 125 443 256  43  32  77 275 426</span>
<span class="co">##  [91] 181 273 451 142 332 442 257 119 489  39 305  63 127 263 424 289  60  78</span>
<span class="co">## [109]  59 314 148  90 387 455 411 502  65 267 269 176  31 484  70 196 435 439</span>
<span class="co">## [127] 492 410 473 313 154 506 210 377 499 482  96 431 452  49  92 178 270 265</span>
<span class="co">## [145] 219 461 297 415 120  58 333 117 497 349 141 266 445 164  36 329 389  81</span>
<span class="co">## [163] 339  98 348 380 474  13 221 414 264 375 352 107  12 308 280 384 177 295</span>
<span class="co">## [181] 143 165 126 227 189 393 447 183  50 290 209 360 504  27 139 402 255 422</span>
<span class="co">## [199] 312 315 372 251 491 104 416 400 138 501 330 454 485 199 417 302 498  56</span>
<span class="co">## [217] 413 460   2 428 351 156 356 163 215 197 394 288 354 376 448 171 287 390</span>
<span class="co">## [235] 242 370   7 303 167  45  91 353 344 102 403 274  64 106  76 294 419 378</span>
<span class="co">## [253] 228 204  73 379 284 463 161 355 323 272  87 111 418  53  21 316  94 486</span>
<span class="co">## [271] 131 381 293 425  85 388 214 345 276 182  61 108 325 145  68 246 121  19</span>
<span class="co">## [289] 427   6 234 259  35 341 133 391  67 175 421 195  99 216 365 503 248  44</span>
<span class="co">## [307] 173 459 236  11 286  52 296 335 475 144 359 432 429 331 114 123 113 311</span>
<span class="co">## [325]   4 186  86 187 279 268 140 409 363 206  84   3 192</span>
<span class="co">## </span>
<span class="co">## $train.inds[[2]]</span>
<span class="co">##   [1] 235  79 249  16 212 456 457 105  38 449 172 357  72 500  20   9 321 436</span>
<span class="co">##  [19] 458 385 200  47 208 396 193 205 350 129 261 496 241 132 278 406  25 340</span>
<span class="co">##  [37] 118 306 440 453 277  80 188  54 224 225 328  95  51 319 505 247  97 238</span>
<span class="co">##  [55] 223   5 407  62  22 300 153 309 358  46  17 383 322 198 162 441 202 240</span>
<span class="co">##  [73]  40 125 230 194 426 343 433 181 273 451 434  82 142 332 442 467 489  39</span>
<span class="co">##  [91] 127 263  48 364 367 326 101 362 347 471 338 213 124  60 401 185 314 148</span>
<span class="co">## [109]  18 387 455 411 476 502  65 488 260 267 336  34 484 410 313 154 271  29</span>
<span class="co">## [127] 210 377 499 482 320 166 307 483 431 452  92 178 211 494 270 477 170 404</span>
<span class="co">## [145] 265  30 219 304 231 461 297 495   8 117 374 262 266 164  36 368 155 329</span>
<span class="co">## [163] 334 389 412 339 337  98 134 479 380 184 115  13  57 414 264  23 352 229</span>
<span class="co">## [181] 157 384 150 177 250 165 126 227 147 258 487  50 290 465 174 292 209  93</span>
<span class="co">## [199] 504  27 139 422 310 245 222 491 299  33 416 399 138 480 501 330 199 342</span>
<span class="co">## [217] 168 493 128 137 233  41  56 180 428 156 478 163 215 197 394 376 135 386</span>
<span class="co">## [235] 287 242   7 239  69 468 353  89 472 344   1 481 102 274  64 395 110  76</span>
<span class="co">## [253]  37  74  14 298 294 419 318 228 122 371  73 463 161 355 272  87 369 111</span>
<span class="co">## [271] 112 418 254 283  53 316  94 159 131 293 425  28 324 281 345 217 109 276</span>
<span class="co">## [289] 446 182 325 145  68 158 121  19 405   6 259 341 201 291 391  67  15 421</span>
<span class="co">## [307] 195 301 503  44 244  66 236  11 286 408  52 144 432 429 253 207   4  86</span>
<span class="co">## [325] 392 187 268  75 409 363 160 373 206  84 469 192 191</span>
<span class="co">## </span>
<span class="co">## $train.inds[[3]]</span>
<span class="co">##   [1] 366 249 466 361  88 346 218 212 438 444 397  55 457 105 327 226 449 357</span>
<span class="co">##  [19] 252  72  20   9 321 450 436 458 385 464 149 200 136  71 423 396 203 193</span>
<span class="co">##  [37] 462 116 243 496 490 132 278 430  25 420 118  10 306 440 453 100 190  26</span>
<span class="co">##  [55]  80  54 437 130 224 282 317 319 398 505 237 247 285 146  97  24 407  62</span>
<span class="co">##  [73]  22 152 153 232 309 358 151  46  17 169 470  42  83 179 103 441 220 382</span>
<span class="co">##  [91]  40 230 443 256  43  32  77 275 194 343 433 434  82 257 119 467 305  63</span>
<span class="co">## [109] 424  48 289 364 367 326 101 362 347 471 338 213 124 401 185  78  59  90</span>
<span class="co">## [127]  18 476 488 260 336 269  34 176  31  70 196 435 439 492 473 271 506  29</span>
<span class="co">## [145] 320 166 307  96 483  49 211 494 477 170 404  30 304 231 415 120 495  58</span>
<span class="co">## [163]   8 333 374 497 349 141 262 445 368 155 334 412  81 337 134 479 348 474</span>
<span class="co">## [181] 184 115  57 221  23 375 107  12 308 280 229 157 150 250 295 143 147 189</span>
<span class="co">## [199] 258 393 447 487 183 465 174 292 360  93 402 255 312 315 310 372 245 251</span>
<span class="co">## [217] 222 104 299  33 399 400 480 454 485 342 168 417 493 128 137 302 233 498</span>
<span class="co">## [235]  41 413 460   2 180 351 478 356 288 354 135 448 386 171 390 370 239 303</span>
<span class="co">## [253] 167  45  69 468  91  89 472   1 481 403 395 110 106  37  74  14 298 318</span>
<span class="co">## [271] 378 122 204 371 379 284 323 369 112 254 283  21 486 159 381  28  85 388</span>
<span class="co">## [289] 324 281 214 217 109 446  61 108 246 158 405 427 234  35 133 201 291  15</span>
<span class="co">## [307] 175 301  99 216 365 248 244  66 173 459 408 296 335 475 359 331 253 114</span>
<span class="co">## [325] 123 207 113 311 186 392 279 140  75 160 373 469   3 191</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $test.inds</span>
<span class="co">## $test.inds[[1]]</span>
<span class="co">##   [1]   1   8   9  14  15  17  18  20  22  23  25  28  29  30  33  34  37  40</span>
<span class="co">##  [19]  41  46  48  54  57  62  66  69  72  74  75  80  82  89  93  97 101 105</span>
<span class="co">##  [37] 109 110 112 115 118 122 124 128 132 134 135 137 147 150 153 155 157 158</span>
<span class="co">##  [55] 159 160 166 168 170 174 180 184 185 191 193 194 200 201 207 211 212 213</span>
<span class="co">##  [73] 217 222 224 229 230 231 233 239 244 245 247 249 250 253 254 258 260 262</span>
<span class="co">##  [91] 271 278 281 283 291 292 298 299 301 304 306 307 309 310 318 319 320 321</span>
<span class="co">## [109] 324 326 334 336 337 338 342 343 347 357 358 362 364 367 368 369 371 373</span>
<span class="co">## [127] 374 385 386 392 395 396 399 401 404 405 407 408 412 433 434 436 440 441</span>
<span class="co">## [145] 446 449 453 457 458 465 467 468 469 471 472 476 477 478 479 480 481 483</span>
<span class="co">## [163] 487 488 493 494 495 496 505</span>
<span class="co">## </span>
<span class="co">## $test.inds[[2]]</span>
<span class="co">##   [1]   2   3  10  12  21  24  26  31  32  35  42  43  45  49  55  58  59  61</span>
<span class="co">##  [19]  63  70  71  77  78  81  83  85  88  90  91  96  99 100 103 104 106 107</span>
<span class="co">##  [37] 108 113 114 116 119 120 123 130 133 136 140 141 143 146 149 151 152 167</span>
<span class="co">##  [55] 169 171 173 175 176 179 183 186 189 190 196 203 204 214 216 218 220 221</span>
<span class="co">##  [73] 226 232 234 237 243 246 248 251 252 255 256 257 269 275 279 280 282 284</span>
<span class="co">##  [91] 285 288 289 295 296 302 303 305 308 311 312 315 317 323 327 331 333 335</span>
<span class="co">## [109] 346 348 349 351 354 356 359 360 361 365 366 370 372 375 378 379 381 382</span>
<span class="co">## [127] 388 390 393 397 398 400 402 403 413 415 417 420 423 424 427 430 435 437</span>
<span class="co">## [145] 438 439 443 444 445 447 448 450 454 459 460 462 464 466 470 473 474 475</span>
<span class="co">## [163] 485 486 490 492 497 498 506</span>
<span class="co">## </span>
<span class="co">## $test.inds[[3]]</span>
<span class="co">##   [1]   4   5   6   7  11  13  16  19  27  36  38  39  44  47  50  51  52  53</span>
<span class="co">##  [19]  56  60  64  65  67  68  73  76  79  84  86  87  92  94  95  98 102 111</span>
<span class="co">##  [37] 117 121 125 126 127 129 131 138 139 142 144 145 148 154 156 161 162 163</span>
<span class="co">##  [55] 164 165 172 177 178 181 182 187 188 192 195 197 198 199 202 205 206 208</span>
<span class="co">##  [73] 209 210 215 219 223 225 227 228 235 236 238 240 241 242 259 261 263 264</span>
<span class="co">##  [91] 265 266 267 268 270 272 273 274 276 277 286 287 290 293 294 297 300 313</span>
<span class="co">## [109] 314 316 322 325 328 329 330 332 339 340 341 344 345 350 352 353 355 363</span>
<span class="co">## [127] 376 377 380 383 384 387 389 391 394 406 409 410 411 414 416 418 419 421</span>
<span class="co">## [145] 422 425 426 428 429 431 432 442 451 452 455 456 461 463 482 484 489 491</span>
<span class="co">## [163] 499 500 501 502 503 504</span></code></pre></div>
</div>
</div>
<div id="stratification-blocking-and-grouping" class="section level2">
<h2 class="hasAnchor">
<a href="#stratification-blocking-and-grouping" class="anchor"></a>Stratification, Blocking and Grouping</h2>
<ul>
<li><p><em>Stratification</em> with respect to a categorical variable makes sure that all its values are present in each training and test set in approximately the same proportion as in the original data set. Stratification is possible with regard to categorical target variables (and thus for supervised classification and survival analysis) or categorical explanatory variables.</p></li>
<li><p><em>Blocking</em> refers to the situation that subsets of observations belong together and must not be separated during resampling. Hence, for one train/test set pair the entire block is either in the training set or in the test set.</p></li>
<li><p><em>Grouping</em> means that the folds are composed out of a factor vector given by the user. In this setting no repetitions are possible as all folds are predefined. The approach can also be used in a nested resampling setting. Note the subtle but important difference to “Blocking”: In “Blocking” factor levels are respected when splitting into train and test (e.g. the test set could be composed out of two given factor levels) whereas in “Grouping” the folds will strictly follow the factor level grouping (meaning that the test set will always only consist of one factor level).</p></li>
</ul>
<div id="stratification-with-respect-to-the-target-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#stratification-with-respect-to-the-target-variables" class="anchor"></a>Stratification with respect to the target variable(s)</h3>
<p>For classification, it is usually desirable to have the same proportion of the classes in all of the partitions of the original data set. This is particularly useful in the case of imbalanced classes and small data sets. Otherwise, it may happen that observations of less frequent classes are missing in some of the training sets which can decrease the performance of the learner, or lead to model crashes. In order to conduct stratified resampling, set <code>stratify = TRUE</code> in <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 3-fold cross-validation</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span>, stratify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"classif.lda"</span>, <span class="va">iris.task</span>, <span class="va">rdesc</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">r</span>
<span class="co">## Resample Result</span>
<span class="co">## Task: iris-example</span>
<span class="co">## Learner: classif.lda</span>
<span class="co">## Aggr perf: mmce.test.mean=0.0200000</span>
<span class="co">## Runtime: 0.0176296</span></code></pre></div>
<p>Stratification is also available for survival tasks. Here the stratification balances the censoring rate.</p>
</div>
<div id="stratification-with-respect-to-explanatory-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#stratification-with-respect-to-explanatory-variables" class="anchor"></a>Stratification with respect to explanatory variables</h3>
<p>Sometimes it is required to also stratify on the input data, e.g., to ensure that all subgroups are represented in all training and test sets. To stratify on the input columns, specify <code>factor</code> columns of your task data via <code>stratify.cols</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span>, stratify.cols <span class="op">=</span> <span class="st">"chas"</span><span class="op">)</span>

<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"regr.rpart"</span>, <span class="va">bh.task</span>, <span class="va">rdesc</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">r</span>
<span class="co">## Resample Result</span>
<span class="co">## Task: BostonHousing-example</span>
<span class="co">## Learner: regr.rpart</span>
<span class="co">## Aggr perf: mse.test.mean=23.8843587</span>
<span class="co">## Runtime: 0.0268815</span></code></pre></div>
</div>
<div id="blocking-cv-with-flexible-predefined-indices" class="section level3">
<h3 class="hasAnchor">
<a href="#blocking-cv-with-flexible-predefined-indices" class="anchor"></a>Blocking: CV with flexible predefined indices</h3>
<p>If some observations “belong together” and must not be separated when splitting the data into training and test sets for resampling, you can supply this information via a <code>blocking</code> factor when creating the <a href="task.html" target="_blank">task</a>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 5 blocks containing 30 observations each</span>
<span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeClassifTask.html">makeClassifTask</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, target <span class="op">=</span> <span class="st">"Species"</span>, blocking <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, each <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">task</span>
<span class="co">## Supervised task: iris</span>
<span class="co">## Type: classif</span>
<span class="co">## Target: Species</span>
<span class="co">## Observations: 150</span>
<span class="co">## Features:</span>
<span class="co">##    numerics     factors     ordered functionals </span>
<span class="co">##           4           0           0           0 </span>
<span class="co">## Missings: FALSE</span>
<span class="co">## Has weights: FALSE</span>
<span class="co">## Has blocking: TRUE</span>
<span class="co">## Has coordinates: FALSE</span>
<span class="co">## Classes: 3</span>
<span class="co">##     setosa versicolor  virginica </span>
<span class="co">##         50         50         50 </span>
<span class="co">## Positive class: NA</span></code></pre></div>
<p>When performing a simple “CV” resampling and inspecting the result, we see that the training indices in fold 1 correspond to the specified grouping set in <code>blocking</code> in the task. To initiate this method, we need to set <code>blocking.cv = TRUE</code> when creating the resample description object.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span>, blocking.cv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"classif.lda"</span>, <span class="va">task</span>, <span class="va">rdesc</span><span class="op">)</span>
<span class="co">## Resampling: cross-validation</span>
<span class="co">## Measures:             mmce</span>
<span class="co">## [Resample] iter 1:    0.0000000</span>
<span class="co">## [Resample] iter 2:    0.0500000</span>
<span class="co">## [Resample] iter 3:    0.0500000</span>
<span class="co">## </span>
<span class="co">## Aggregated Result: mmce.test.mean=0.0333333</span>
<span class="co">## </span>

<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">pred</span><span class="op">$</span><span class="va">instance</span><span class="op">$</span><span class="va">train.inds</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">##   [1]  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48</span>
<span class="co">##  [19]  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66</span>
<span class="co">##  [37]  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84</span>
<span class="co">##  [55]  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102</span>
<span class="co">##  [73] 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120</span>
<span class="co">##  [91] 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138</span>
<span class="co">## [109] 139 140 141 142 143 144 145 146 147 148 149 150</span></code></pre></div>
<p>However, please note the effects of this method: The created folds will not have the same size! Here, Fold 1 has a 120/30 split while the other two folds have a 90/60 split.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">pred</span><span class="op">$</span><span class="va">instance</span><span class="op">$</span><span class="va">train.inds</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [[1]]</span>
<span class="co">## [1] 120</span>
<span class="co">## </span>
<span class="co">## [[2]]</span>
<span class="co">## [1] 90</span>
<span class="co">## </span>
<span class="co">## [[3]]</span>
<span class="co">## [1] 90</span></code></pre></div>
<p>This is caused by the fact that we supplied five groups that must belong together but only used a three fold resampling strategy here.</p>
</div>
<div id="grouping-cv-with-fixed-predefined-indices" class="section level3">
<h3 class="hasAnchor">
<a href="#grouping-cv-with-fixed-predefined-indices" class="anchor"></a>Grouping: CV with fixed predefined indices</h3>
<p>There is a second way of using predefined indices in resampling in <code>mlr</code>: Constructing the folds based on the supplied indices in <code>blocking</code>. We refer to this method here as “grouping” to distinguish it from “blocking”. This method is more restrictive in the way that it will always use the number of levels supplied via <code>blocking</code> as the number of folds. To use this method, we need to set <code>fixed = TRUE</code> instead of <code>blocking.cv</code> when creating the resampling description object.</p>
<p>We can leave out the <code>iters</code> argument, as it will be set internally to the number of supplied factor levels.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"classif.lda"</span>, <span class="va">task</span>, <span class="va">rdesc</span><span class="op">)</span>
<span class="co">## Warning in makeResampleInstance(resampling, task = task): 'Blocking' features in</span>
<span class="co">## the task were detected but 'blocking.cv' was not set in 'resample()'.</span>
<span class="co">## Warning in makeResampleInstance(resampling, task = task): Setting 'blocking.cv'</span>
<span class="co">## to TRUE to prevent undesired behavior. Set `blocking.cv' = TRUE` in</span>
<span class="co">## `makeResampleDesc()` to silence this warning'.</span>
<span class="co">## Warning in instantiateResampleInstance.CVDesc(desc, size, task): Adjusting</span>
<span class="co">## levels to match number of blocking levels.</span>
<span class="co">## Resampling: cross-validation</span>
<span class="co">## Measures:             mmce</span>
<span class="co">## [Resample] iter 1:    0.0000000</span>
<span class="co">## [Resample] iter 2:    0.1000000</span>
<span class="co">## [Resample] iter 3:    0.0000000</span>
<span class="co">## [Resample] iter 4:    0.1000000</span>
<span class="co">## [Resample] iter 5:    0.0000000</span>
<span class="co">## </span>
<span class="co">## Aggregated Result: mmce.test.mean=0.0400000</span>
<span class="co">## </span>
<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">pred</span><span class="op">$</span><span class="va">instance</span><span class="op">$</span><span class="va">train.inds</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">##   [1]  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48</span>
<span class="co">##  [19]  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66</span>
<span class="co">##  [37]  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84</span>
<span class="co">##  [55]  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102</span>
<span class="co">##  [73] 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120</span>
<span class="co">##  [91] 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138</span>
<span class="co">## [109] 139 140 141 142 143 144 145 146 147 148 149 150</span></code></pre></div>
<p>You can see that we automatically created five folds in which the test set always corresponds to one factor level.</p>
<p>Doing it this way also means that we cannot do repeated CV because there is no way to create multiple shuffled folds of this fixed arrangement.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">pred</span><span class="op">$</span><span class="va">instance</span><span class="op">$</span><span class="va">train.inds</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="co">## [[1]]</span>
<span class="co">## [1] 120</span>
<span class="co">## </span>
<span class="co">## [[2]]</span>
<span class="co">## [1] 120</span>
<span class="co">## </span>
<span class="co">## [[3]]</span>
<span class="co">## [1] 120</span>
<span class="co">## </span>
<span class="co">## [[4]]</span>
<span class="co">## [1] 120</span>
<span class="co">## </span>
<span class="co">## [[5]]</span>
<span class="co">## [1] 120</span></code></pre></div>
<p>However, this method can also be used in nested resampling settings (e.g. in hyperparameter tuning). In the inner level, the factor levels are honored and the function simply creates one fold less than in the outer level.</p>
<p>Please note that the <code>iters</code> argument has no effect in <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code> if <code>fixed = TRUE</code>. The number of folds will be automatically set based on the supplied number of factor levels via <code>blocking</code>. In the inner level, the number of folds will simply be one less than in the outer level.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># test fixed in nested resampling</span>
<span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.lda"</span><span class="op">)</span>
<span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/makeTuneControlRandom.html">makeTuneControlRandom</a></span><span class="op">(</span>maxit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paramhelpers.mlr-org.com/reference/makeParamSet.html">makeParamSet</a></span><span class="op">(</span><span class="fu"><a href="https://paramhelpers.mlr-org.com/reference/Param.html">makeNumericParam</a></span><span class="op">(</span><span class="st">"nu"</span>, lower <span class="op">=</span> <span class="fl">2</span>, upper <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="va">inner</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">outer</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">tune_wrapper</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span><span class="op">(</span><span class="va">lrn</span>, resampling <span class="op">=</span> <span class="va">inner</span>, par.set <span class="op">=</span> <span class="va">ps</span>,
  control <span class="op">=</span> <span class="va">ctrl</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="va">tune_wrapper</span>, <span class="va">task</span>, <span class="va">outer</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span>,
  extract <span class="op">=</span> <span class="va">getTuneResult</span><span class="op">)</span></code></pre></div>
<p>To check on the inner resampling indices, you can call <code>getResamplingIndices(inner = TRUE)</code>. You can see that for every outer fold (List of 5), four inner folds were created that respect the grouping supplied via the <code>blocking</code> argument.</p>
<p>Of course you can also use a normal random sampling “CV” description in the inner level by just setting <code>fixed = FALSE</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="fu"><a href="../../reference/getResamplingIndices.html">getResamplingIndices</a></span><span class="op">(</span><span class="va">p</span>, inner <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">## List of 5</span>
<span class="co">##  $ :List of 2</span>
<span class="co">##   ..$ train.inds:List of 4</span>
<span class="co">##   .. ..$ : int [1:90] 106 93 149 103 133 150 119 48 100 142 ...</span>
<span class="co">##   .. ..$ : int [1:90] 106 11 93 149 29 103 133 150 27 119 ...</span>
<span class="co">##   .. ..$ : int [1:90] 106 11 93 29 103 27 119 48 3 100 ...</span>
<span class="co">##   .. ..$ : int [1:90] 11 149 29 133 150 27 48 3 26 142 ...</span>
<span class="co">##   ..$ test.inds :List of 4</span>
<span class="co">##   .. ..$ : int [1:30] 23 22 13 18 10 16 1 30 11 15 ...</span>
<span class="co">##   .. ..$ : int [1:30] 35 46 37 54 31 53 51 58 48 33 ...</span>
<span class="co">##   .. ..$ : int [1:30] 138 146 149 126 123 143 124 139 136 150 ...</span>
<span class="co">##   .. ..$ : int [1:30] 99 104 109 112 108 111 98 115 117 100 ...</span>
<span class="co">##  $ :List of 2</span>
<span class="co">##   ..$ train.inds:List of 4</span>
<span class="co">##   .. ..$ : int [1:90] 116 40 83 103 84 97 114 53 57 47 ...</span>
<span class="co">##   .. ..$ : int [1:90] 128 40 83 84 146 141 140 53 57 142 ...</span>
<span class="co">##   .. ..$ : int [1:90] 116 128 83 103 84 146 97 141 140 114 ...</span>
<span class="co">##   .. ..$ : int [1:90] 116 128 40 103 146 97 141 140 114 53 ...</span>
<span class="co">##   ..$ test.inds :List of 4</span>
<span class="co">##   .. ..$ : int [1:30] 138 146 149 126 123 143 124 139 136 150 ...</span>
<span class="co">##   .. ..$ : int [1:30] 99 104 109 112 108 111 98 115 117 100 ...</span>
<span class="co">##   .. ..$ : int [1:30] 35 46 37 54 31 53 51 58 48 33 ...</span>
<span class="co">##   .. ..$ : int [1:30] 74 68 78 88 67 73 62 85 86 89 ...</span>
<span class="co">##  $ :List of 2</span>
<span class="co">##   ..$ train.inds:List of 4</span>
<span class="co">##   .. ..$ : int [1:90] 41 113 18 36 22 108 5 29 120 4 ...</span>
<span class="co">##   .. ..$ : int [1:90] 75 82 41 113 78 36 108 61 120 57 ...</span>
<span class="co">##   .. ..$ : int [1:90] 75 82 113 78 18 22 108 5 29 61 ...</span>
<span class="co">##   .. ..$ : int [1:90] 75 82 41 78 18 36 22 5 29 61 ...</span>
<span class="co">##   ..$ test.inds :List of 4</span>
<span class="co">##   .. ..$ : int [1:30] 74 68 78 88 67 73 62 85 86 89 ...</span>
<span class="co">##   .. ..$ : int [1:30] 23 22 13 18 10 16 1 30 11 15 ...</span>
<span class="co">##   .. ..$ : int [1:30] 35 46 37 54 31 53 51 58 48 33 ...</span>
<span class="co">##   .. ..$ : int [1:30] 99 104 109 112 108 111 98 115 117 100 ...</span>
<span class="co">##  $ :List of 2</span>
<span class="co">##   ..$ train.inds:List of 4</span>
<span class="co">##   .. ..$ : int [1:90] 123 145 109 92 84 103 70 116 90 131 ...</span>
<span class="co">##   .. ..$ : int [1:90] 123 145 30 1 21 109 92 103 116 8 ...</span>
<span class="co">##   .. ..$ : int [1:90] 123 145 30 1 21 84 70 8 4 90 ...</span>
<span class="co">##   .. ..$ : int [1:90] 30 1 21 109 92 84 103 70 116 8 ...</span>
<span class="co">##   ..$ test.inds :List of 4</span>
<span class="co">##   .. ..$ : int [1:30] 23 22 13 18 10 16 1 30 11 15 ...</span>
<span class="co">##   .. ..$ : int [1:30] 74 68 78 88 67 73 62 85 86 89 ...</span>
<span class="co">##   .. ..$ : int [1:30] 99 104 109 112 108 111 98 115 117 100 ...</span>
<span class="co">##   .. ..$ : int [1:30] 138 146 149 126 123 143 124 139 136 150 ...</span>
<span class="co">##  $ :List of 2</span>
<span class="co">##   ..$ train.inds:List of 4</span>
<span class="co">##   .. ..$ : int [1:90] 25 11 12 26 63 138 137 69 14 15 ...</span>
<span class="co">##   .. ..$ : int [1:90] 44 25 33 11 12 48 51 26 34 138 ...</span>
<span class="co">##   .. ..$ : int [1:90] 44 25 33 11 12 48 51 26 63 34 ...</span>
<span class="co">##   .. ..$ : int [1:90] 44 33 48 51 63 34 138 137 69 46 ...</span>
<span class="co">##   ..$ test.inds :List of 4</span>
<span class="co">##   .. ..$ : int [1:30] 35 46 37 54 31 53 51 58 48 33 ...</span>
<span class="co">##   .. ..$ : int [1:30] 74 68 78 88 67 73 62 85 86 89 ...</span>
<span class="co">##   .. ..$ : int [1:30] 138 146 149 126 123 143 124 139 136 150 ...</span>
<span class="co">##   .. ..$ : int [1:30] 23 22 13 18 10 16 1 30 11 15 ...</span></code></pre></div>
</div>
</div>
<div id="resample-descriptions-and-resample-instances" class="section level2">
<h2 class="hasAnchor">
<a href="#resample-descriptions-and-resample-instances" class="anchor"></a>Resample descriptions and resample instances</h2>
<p>As already mentioned, you can specify a resampling strategy using function <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">rdesc</span>
<span class="co">## Resample description: cross-validation with 3 iterations.</span>
<span class="co">## Predict: test</span>
<span class="co">## Stratification: FALSE</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">rdesc</span><span class="op">)</span>
<span class="co">## List of 6</span>
<span class="co">##  $ fixed      : logi FALSE</span>
<span class="co">##  $ blocking.cv: logi FALSE</span>
<span class="co">##  $ id         : chr "cross-validation"</span>
<span class="co">##  $ iters      : int 3</span>
<span class="co">##  $ predict    : chr "test"</span>
<span class="co">##  $ stratify   : logi FALSE</span>
<span class="co">##  - attr(*, "class")= chr [1:2] "CVDesc" "ResampleDesc"</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"Subsample"</span>, stratify.cols <span class="op">=</span> <span class="st">"chas"</span><span class="op">)</span><span class="op">)</span>
<span class="co">## List of 8</span>
<span class="co">##  $ split        : num 0.667</span>
<span class="co">##  $ id           : chr "subsampling"</span>
<span class="co">##  $ iters        : int 30</span>
<span class="co">##  $ predict      : chr "test"</span>
<span class="co">##  $ stratify     : logi FALSE</span>
<span class="co">##  $ stratify.cols: chr "chas"</span>
<span class="co">##  $ fixed        : logi FALSE</span>
<span class="co">##  $ blocking.cv  : logi FALSE</span>
<span class="co">##  - attr(*, "class")= chr [1:2] "SubsampleDesc" "ResampleDesc"</span></code></pre></div>
<p>The result <code>rdesc</code> inherits from class <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) (short for resample description) and, in principle, contains all necessary information about the resampling strategy including the number of iterations, the proportion of training and test sets, stratification variables, etc.</p>
<p>Given either the size of the data set at hand or the <code><a href="../../reference/Task.html">Task()</a></code>, function <code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code> draws the training and test sets according to the <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a resample instance based an a task</span>
<span class="va">rin</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleInstance.html">makeResampleInstance</a></span><span class="op">(</span><span class="va">rdesc</span>, <span class="va">iris.task</span><span class="op">)</span>
<span class="va">rin</span>
<span class="co">## Resample instance for 150 cases.</span>
<span class="co">## Resample description: cross-validation with 3 iterations.</span>
<span class="co">## Predict: test</span>
<span class="co">## Stratification: FALSE</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">rin</span><span class="op">)</span>
<span class="co">## List of 5</span>
<span class="co">##  $ desc      :List of 6</span>
<span class="co">##   ..$ fixed      : logi FALSE</span>
<span class="co">##   ..$ blocking.cv: logi FALSE</span>
<span class="co">##   ..$ id         : chr "cross-validation"</span>
<span class="co">##   ..$ iters      : int 3</span>
<span class="co">##   ..$ predict    : chr "test"</span>
<span class="co">##   ..$ stratify   : logi FALSE</span>
<span class="co">##   ..- attr(*, "class")= chr [1:2] "CVDesc" "ResampleDesc"</span>
<span class="co">##  $ size      : int 150</span>
<span class="co">##  $ train.inds:List of 3</span>
<span class="co">##   ..$ : int [1:100] 75 43 147 7 74 55 104 111 23 9 ...</span>
<span class="co">##   ..$ : int [1:100] 29 20 74 129 124 111 9 31 5 21 ...</span>
<span class="co">##   ..$ : int [1:100] 29 75 43 147 20 7 129 124 55 104 ...</span>
<span class="co">##  $ test.inds :List of 3</span>
<span class="co">##   ..$ : int [1:50] 4 5 6 10 15 17 19 20 21 22 ...</span>
<span class="co">##   ..$ : int [1:50] 1 3 7 11 12 14 16 23 27 33 ...</span>
<span class="co">##   ..$ : int [1:50] 2 8 9 13 18 24 25 26 28 30 ...</span>
<span class="co">##  $ group     : Factor w/ 0 levels: </span>
<span class="co">##  - attr(*, "class")= chr "ResampleInstance"</span>

<span class="co"># Create a resample instance given the size of the data set</span>
<span class="va">rin</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleInstance.html">makeResampleInstance</a></span><span class="op">(</span><span class="va">rdesc</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">rin</span><span class="op">)</span>
<span class="co">## List of 5</span>
<span class="co">##  $ desc      :List of 6</span>
<span class="co">##   ..$ fixed      : logi FALSE</span>
<span class="co">##   ..$ blocking.cv: logi FALSE</span>
<span class="co">##   ..$ id         : chr "cross-validation"</span>
<span class="co">##   ..$ iters      : int 3</span>
<span class="co">##   ..$ predict    : chr "test"</span>
<span class="co">##   ..$ stratify   : logi FALSE</span>
<span class="co">##   ..- attr(*, "class")= chr [1:2] "CVDesc" "ResampleDesc"</span>
<span class="co">##  $ size      : int 150</span>
<span class="co">##  $ train.inds:List of 3</span>
<span class="co">##   ..$ : int [1:100] 38 94 73 82 14 77 75 150 27 85 ...</span>
<span class="co">##   ..$ : int [1:100] 90 82 14 77 75 150 27 56 16 22 ...</span>
<span class="co">##   ..$ : int [1:100] 38 94 73 90 85 36 19 104 127 55 ...</span>
<span class="co">##  $ test.inds :List of 3</span>
<span class="co">##   ..$ : int [1:50] 3 6 10 12 13 15 19 23 25 26 ...</span>
<span class="co">##   ..$ : int [1:50] 2 7 18 20 29 31 33 35 37 38 ...</span>
<span class="co">##   ..$ : int [1:50] 1 4 5 8 9 11 14 16 17 21 ...</span>
<span class="co">##  $ group     : Factor w/ 0 levels: </span>
<span class="co">##  - attr(*, "class")= chr "ResampleInstance"</span>

<span class="co"># Access the indices of the training observations in iteration 3</span>
<span class="va">rin</span><span class="op">$</span><span class="va">train.inds</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>
<span class="co">##   [1]  38  94  73  90  85  36  19 104 127  55 103  91  44  49 132  59  34  12</span>
<span class="co">##  [19]  29 145  25  81  33  86  40 117  99  62 112 119 135 125 146  20  37 107</span>
<span class="co">##  [37] 113  68 149 102 115  74 129 147 130  97 106  76  66  67  50  61   6  72</span>
<span class="co">##  [55]  42  54  45 111  52 108  95 120 101  63  31  43 141  47  51  89 142  23</span>
<span class="co">##  [73] 136 148 116 122  10  13  26 126 123   7  60 118 140 139  18  93  71   2</span>
<span class="co">##  [91]  84  15  35   3 109  79  87 124 114  57</span></code></pre></div>
<p>The result <code>rin</code> inherits from class <code>ResampleInstance</code> (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>) and contains <code>list</code>s of index vectors for the train and test sets.</p>
<p>If a <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) is passed to <code><a href="../../reference/resample.html">resample()</a></code>, it is instantiated internally. Naturally, it is also possible to pass a <code>ResampleInstance</code> (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>) directly.</p>
<p>While the separation between resample descriptions, resample instances, and the <code><a href="../../reference/resample.html">resample()</a></code> function itself seems overly complicated, it has several advantages:</p>
<ul>
<li>Resample instances readily allow for paired experiments, that is comparing the performance of several learners on exactly the same training and test sets. This is particularly useful if you want to add another method to a comparison experiment you already did. Moreover, you can store the resample instance along with your data in order to be able to reproduce your results later on.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">rin</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleInstance.html">makeResampleInstance</a></span><span class="op">(</span><span class="va">rdesc</span>, task <span class="op">=</span> <span class="va">iris.task</span><span class="op">)</span>

<span class="co"># Calculate the performance of two learners based on the same resample instance</span>
<span class="va">r.lda</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"classif.lda"</span>, <span class="va">iris.task</span>, <span class="va">rin</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">r.rpart</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, <span class="va">iris.task</span>, <span class="va">rin</span>, show.info <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">r.lda</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">## mmce.test.mean </span>
<span class="co">##           0.02</span>

<span class="va">r.rpart</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">## mmce.test.mean </span>
<span class="co">##           0.06</span></code></pre></div>
<ul>
<li>In order to add further resampling methods you can simply derive from the <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>) and <code>ResampleInstance</code> (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>) classes, but you do neither have to touch <code><a href="../../reference/resample.html">resample()</a></code> nor any further methods that use the resampling strategy.</li>
</ul>
<p>Usually, when calling <code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code> the train and test index sets are drawn randomly. Mainly for <em>holdout</em> (<em>test sample</em>) <em>estimation</em> you might want full control about the training and tests set and specify them manually. This can be done using function <code><a href="../../reference/makeFixedHoldoutInstance.html">makeFixedHoldoutInstance()</a></code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rin</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeFixedHoldoutInstance.html">makeFixedHoldoutInstance</a></span><span class="op">(</span>train.inds <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, test.inds <span class="op">=</span> <span class="fl">101</span><span class="op">:</span><span class="fl">150</span>, size <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>
<span class="va">rin</span>
<span class="co">## Resample instance for 150 cases.</span>
<span class="co">## Resample description: holdout with 0.67 split rate.</span>
<span class="co">## Predict: test</span>
<span class="co">## Stratification: FALSE</span></code></pre></div>
</div>
<div id="aggregating-performance-values" class="section level2">
<h2 class="hasAnchor">
<a href="#aggregating-performance-values" class="anchor"></a>Aggregating performance values</h2>
<p>In each resampling iteration <span class="math inline">\(b = 1,\ldots,B\)</span> we get performance values <span class="math inline">\(S(D^{*b}, D \setminus D^{*b})\)</span> (for each measure we wish to calculate), which are then aggregated to an overall performance.</p>
<p>For the great majority of common resampling strategies (like holdout, cross-validation, subsampling) performance values are calculated on the test data sets only and for most measures aggregated by taking the mean (<code>test.mean</code>(<code><a href="../../reference/aggregations.html">aggregations()</a></code>)).</p>
<p>Each performance <code>Measure</code> (<code><a href="../../reference/makeMeasure.html">makeMeasure()</a></code>) in <code>mlr</code> has a corresponding default aggregation method which is stored in slot <code>$aggr</code>. The default aggregation for most measures is <code>test.mean</code>(<code><a href="../../reference/aggregations.html">aggregations()</a></code>). One exception is the root mean square error (<a href="measures.html" target="_blank">rmse</a>).</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Mean misclassification error</span>
<span class="va">mmce</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">## Aggregation function: test.mean</span>

<span class="va">mmce</span><span class="op">$</span><span class="va">aggr</span><span class="op">$</span><span class="va">fun</span>
<span class="co">## function (task, perf.test, perf.train, measure, group, pred)</span>
<span class="co">## mean(perf.test)</span>
<span class="co">## &lt;bytecode: 0xc8eade8&gt;</span>
<span class="co">## &lt;environment: namespace:mlr&gt;</span>

<span class="co"># Root mean square error</span>
<span class="va">rmse</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">## Aggregation function: test.rmse</span>

<span class="va">rmse</span><span class="op">$</span><span class="va">aggr</span><span class="op">$</span><span class="va">fun</span>
<span class="co">## function (task, perf.test, perf.train, measure, group, pred)</span>
<span class="co">## sqrt(mean(perf.test^2))</span>
<span class="co">## &lt;bytecode: 0x23ad72d8&gt;</span>
<span class="co">## &lt;environment: namespace:mlr&gt;</span></code></pre></div>
<p>You can change the aggregation method of a <code>Measure</code> (<code><a href="../../reference/makeMeasure.html">makeMeasure()</a></code>) via function <code><a href="../../reference/setAggregation.html">setAggregation()</a></code>. All available aggregation schemes are listed on the <code><a href="../../reference/aggregations.html">aggregations()</a></code> documentation page.</p>
<div id="example-one-measure-with-different-aggregations" class="section level4">
<h4 class="hasAnchor">
<a href="#example-one-measure-with-different-aggregations" class="anchor"></a>Example: One measure with different aggregations</h4>
<p>The aggregation schemes <code>test.median</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>), <code>test.min</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>), and <code>text.max</code> (<code><a href="../../reference/aggregations.html">aggregations()</a></code>) compute the median, minimum, and maximum of the performance values on the test sets.</p>
<pre><code>## Resampling: cross-validation
## Measures:             mse       mse       mse       mse
## [Resample] iter 1:    29.519658829.519658829.519658829.5196588
## [Resample] iter 2:    19.585943919.585943919.585943919.5859439
## [Resample] iter 3:    25.396095325.396095325.396095325.3960953
## 
## Aggregated Result: mse.test.mean=24.8338993,mse.test.median=25.3960953,mse.test.min=19.5859439,mse.test.max=29.5196588
## </code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mseTestMedian</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setAggregation.html">setAggregation</a></span><span class="op">(</span><span class="va">mse</span>, <span class="va">test.median</span><span class="op">)</span>
<span class="va">mseTestMin</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setAggregation.html">setAggregation</a></span><span class="op">(</span><span class="va">mse</span>, <span class="va">test.min</span><span class="op">)</span>
<span class="va">mseTestMax</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setAggregation.html">setAggregation</a></span><span class="op">(</span><span class="va">mse</span>, <span class="va">test.max</span><span class="op">)</span>

<span class="va">mseTestMedian</span>
<span class="co">## Name: Mean of squared errors</span>
<span class="co">## Performance measure: mse</span>
<span class="co">## Properties: regr,req.pred,req.truth</span>
<span class="co">## Minimize: TRUE</span>
<span class="co">## Best: 0; Worst: Inf</span>
<span class="co">## Aggregated by: test.median</span>
<span class="co">## Arguments:</span>
<span class="co">## Note: Defined as: mean((response - truth)^2)</span>

<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"regr.lm"</span>, <span class="va">bh.task</span>, <span class="va">rdesc</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mse</span>, <span class="va">mseTestMedian</span>, <span class="va">mseTestMin</span>, <span class="va">mseTestMax</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Resampling: cross-validation</span>
<span class="co">## Measures:             mse       mse       mse       mse</span>
<span class="co">## [Resample] iter 1:    24.078202624.078202624.078202624.0782026</span>
<span class="co">## [Resample] iter 2:    29.498307729.498307729.498307729.4983077</span>
<span class="co">## [Resample] iter 3:    18.689471818.689471818.689471818.6894718</span>
<span class="co">##</span>
<span class="co">## Aggregated Result: mse.test.mean=24.0886607,mse.test.median=24.0782026,mse.test.min=18.6894718,mse.test.max=29.4983077</span>
<span class="co">##</span>

<span class="va">r</span>
<span class="co">## Resample Result</span>
<span class="co">## Task: BostonHousing-example</span>
<span class="co">## Learner: regr.lm</span>
<span class="co">## Aggr perf: mse.test.mean=24.0886607,mse.test.median=24.0782026,mse.test.min=18.6894718,mse.test.max=29.4983077</span>
<span class="co">## Runtime: 0.0288048</span>

<span class="va">r</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">##   mse.test.mean mse.test.median    mse.test.min    mse.test.max</span>
<span class="co">##        24.08866        24.07820        18.68947        29.49831</span></code></pre></div>
</div>
<div id="example-calculating-the-training-error" class="section level3">
<h3 class="hasAnchor">
<a href="#example-calculating-the-training-error" class="anchor"></a>Example: Calculating the training error</h3>
<p>Below we calculate the mean misclassification error (<a href="measures.html" target="_blank">mmce</a>) on the training and the test data sets. Note that we have to set <code>predict = "both"</code> when calling <code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code> in order to get predictions on both training and test sets.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mmceTrainMean</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setAggregation.html">setAggregation</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">train.mean</span><span class="op">)</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"CV"</span>, iters <span class="op">=</span> <span class="fl">3</span>, predict <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span>
<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, <span class="va">iris.task</span>, <span class="va">rdesc</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">mmceTrainMean</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Resampling: cross-validation</span>
<span class="co">## Measures:             mmce.train   mmce.test</span>
<span class="co">## [Resample] iter 1:    0.0300000    0.0600000</span>
<span class="co">## [Resample] iter 2:    0.0400000    0.0600000</span>
<span class="co">## [Resample] iter 3:    0.0300000    0.0600000</span>
<span class="co">## </span>
<span class="co">## Aggregated Result: mmce.test.mean=0.0600000,mmce.train.mean=0.0333333</span>
<span class="co">## </span>

<span class="va">r</span><span class="op">$</span><span class="va">measures.train</span>
<span class="co">##   iter mmce mmce</span>
<span class="co">## 1    1 0.03 0.03</span>
<span class="co">## 2    2 0.04 0.04</span>
<span class="co">## 3    3 0.03 0.03</span>

<span class="va">r</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">##  mmce.test.mean mmce.train.mean </span>
<span class="co">##      0.06000000      0.03333333</span></code></pre></div>
</div>
<div id="example-bootstrap" class="section level3">
<h3 class="hasAnchor">
<a href="#example-bootstrap" class="anchor"></a>Example: Bootstrap</h3>
<p>In <em>out-of-bag bootstrap estimation</em> <span class="math inline">\(B\)</span> new data sets <span class="math inline">\(D^{*1}, \ldots, D^{*B}\)</span> are drawn from the data set <span class="math inline">\(D\)</span> with replacement, each of the same size as <span class="math inline">\(D\)</span>. In the <span class="math inline">\(b\)</span>-th iteration, <span class="math inline">\(D^{*b}\)</span> forms the training set, while the remaining elements from <span class="math inline">\(D\)</span>, i.e., <span class="math inline">\(D \setminus D^{*b}\)</span>, form the test set.</p>
<!--(
                     |resampling_desc_figure|

                     |resampling_nested_resampling_figure|
)-->
<p>The <em>b632</em> and <em>b632+</em> variants calculate a convex combination of the training performance and the out-of-bag bootstrap performance and thus require predictions on the training sets and an appropriate aggregation strategy.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use bootstrap as resampling strategy and predict on both train and test sets</span>
<span class="va">rdesc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span><span class="op">(</span><span class="st">"Bootstrap"</span>, predict <span class="op">=</span> <span class="st">"both"</span>, iters <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="co"># Set aggregation schemes for b632 and b632+ bootstrap</span>
<span class="va">mmceB632</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setAggregation.html">setAggregation</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">b632</span><span class="op">)</span>
<span class="va">mmceB632plus</span> <span class="op">=</span> <span class="fu"><a href="../../reference/setAggregation.html">setAggregation</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">b632plus</span><span class="op">)</span>

<span class="va">mmceB632</span>
<span class="co">## Name: Mean misclassification error</span>
<span class="co">## Performance measure: mmce</span>
<span class="co">## Properties: classif,classif.multi,req.pred,req.truth</span>
<span class="co">## Minimize: TRUE</span>
<span class="co">## Best: 0; Worst: 1</span>
<span class="co">## Aggregated by: b632</span>
<span class="co">## Arguments: </span>
<span class="co">## Note: Defined as: mean(response != truth)</span>

<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../../reference/resample.html">resample</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, <span class="va">iris.task</span>, <span class="va">rdesc</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">mmceB632</span>, <span class="va">mmceB632plus</span><span class="op">)</span>,
  show.info <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">measures.train</span><span class="op">)</span>
<span class="co">##   iter       mmce       mmce       mmce</span>
<span class="co">## 1    1 0.04000000 0.04000000 0.04000000</span>
<span class="co">## 2    2 0.02666667 0.02666667 0.02666667</span>
<span class="co">## 3    3 0.04666667 0.04666667 0.04666667</span>
<span class="co">## 4    4 0.02666667 0.02666667 0.02666667</span>
<span class="co">## 5    5 0.03333333 0.03333333 0.03333333</span>
<span class="co">## 6    6 0.02000000 0.02000000 0.02000000</span>

<span class="co"># Compare misclassification rates for out-of-bag, b632, and b632+ bootstrap</span>
<span class="va">r</span><span class="op">$</span><span class="va">aggr</span>
<span class="co">## mmce.test.mean      mmce.b632  mmce.b632plus </span>
<span class="co">##     0.05059931     0.04228276     0.04303127</span></code></pre></div>
</div>
</div>
<div id="convenience-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#convenience-functions" class="anchor"></a>Convenience functions</h2>
<p>The functionality described on this page allows for much control and flexibility. However, when quickly trying out some learners, it can get tedious to type all the code for defining the resampling strategy, setting the aggregation scheme and so on. As mentioned above, <code>mlr</code> includes some pre-defined resample description objects for frequently used strategies like, e.g., 5-fold cross-validation (<code>cv5</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)). Moreover, <code>mlr</code> provides special functions for the most common resampling methods, for example <code>holdout</code> (<code><a href="../../reference/resample.html">resample()</a></code>), <code>crossval</code> (<code><a href="../../reference/resample.html">resample()</a></code>), or <code>bootstrapB632</code> (<code><a href="../../reference/resample.html">resample()</a></code>).</p>
<pre><code>## Resampling: cross-validation
## Measures:             mmce      ber
## [Resample] iter 1:    0.0400000 0.0444444
## [Resample] iter 2:    0.0000000 0.0000000
## [Resample] iter 3:    0.0200000 0.0303030
## 
## Aggregated Result: mmce.test.mean=0.0200000,ber.test.mean=0.0249158
## 
## Resampling: OOB bootstrapping
## Measures:             mse.train   mae.train   mse.test    mae.test
## [Resample] iter 1:    23.4927114  3.6008531   25.7782322  3.7183011
## [Resample] iter 2:    18.5886427  2.9238599   27.5961506  3.7304597
## [Resample] iter 3:    20.6455357  3.1039182   26.2183904  3.6727966
## 
## Aggregated Result: mse.b632plus=24.5409802,mae.b632plus=3.5372475
## </code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/resample.html">crossval</a></span><span class="op">(</span><span class="st">"classif.lda"</span>, <span class="va">iris.task</span>, iters <span class="op">=</span> <span class="fl">3</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mmce</span>, <span class="va">ber</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Resampling: cross-validation</span>
<span class="co">## Measures:             mmce      ber</span>
<span class="co">## [Resample] iter 1:    0.0200000 0.0238095</span>
<span class="co">## [Resample] iter 2:    0.0400000 0.0370370</span>
<span class="co">## [Resample] iter 3:    0.0000000 0.0000000</span>
<span class="co">##</span>
<span class="co">## Aggregated Result: mmce.test.mean=0.0200000,ber.test.mean=0.0202822</span>
<span class="co">##</span>
<span class="co">## Resample Result</span>
<span class="co">## Task: iris-example</span>
<span class="co">## Learner: classif.lda</span>
<span class="co">## Aggr perf: mmce.test.mean=0.0200000,ber.test.mean=0.0202822</span>
<span class="co">## Runtime: 0.0205457</span>

<span class="fu"><a href="../../reference/resample.html">bootstrapB632plus</a></span><span class="op">(</span><span class="st">"regr.lm"</span>, <span class="va">bh.task</span>, iters <span class="op">=</span> <span class="fl">3</span>, measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mse</span>, <span class="va">mae</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Resampling: OOB bootstrapping</span>
<span class="co">## Measures:             mse.train   mae.train   mse.test    mae.test</span>
<span class="co">## [Resample] iter 1:    24.6425511  3.4107320   16.3415466  3.0123263</span>
<span class="co">## [Resample] iter 2:    17.0963191  2.9809210   29.6056968  3.7131236</span>
<span class="co">## [Resample] iter 3:    23.1440608  3.5079975   24.4183753  3.3467443</span>
<span class="co">##</span>
<span class="co">## Aggregated Result: mse.b632plus=22.9359054,mae.b632plus=3.3459751</span>
<span class="co">##</span>
<span class="co">## Resample Result</span>
<span class="co">## Task: BostonHousing-example</span>
<span class="co">## Learner: regr.lm</span>
<span class="co">## Aggr perf: mse.b632plus=22.9359054,mae.b632plus=3.3459751</span>
<span class="co">## Runtime: 0.0419419</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bernd Bischl, Michel Lang, Lars Kotthoff, Patrick Schratz, Julia Schiffner, Jakob Richter, Zachary Jones, Giuseppe Casalicchio, Mason Gallo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'e300ecafdf04fe1199e3339c825ce7d0',
    indexName: 'mlr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
