<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mlr">
<title>Training a Learner • mlr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../../deps/Roboto-0.4.2/font.css" rel="stylesheet">
<link href="../../deps/JetBrains_Mono-0.4.2/font.css" rel="stylesheet">
<link href="../../deps/Roboto_Slab-0.4.2/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Training a Learner">
<meta property="og:description" content="mlr">
<meta property="og:image" content="https://mlr.mlr-org.com/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">mlr</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.19.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-basics">Basics</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-basics">
    <a class="dropdown-item" href="../../articles/tutorial/task.html">Task</a>
    <a class="dropdown-item" href="../../articles/tutorial/learner.html">Learner</a>
    <a class="dropdown-item" href="../../articles/tutorial/train.html">Train</a>
    <a class="dropdown-item" href="../../articles/tutorial/predict.html">Predict</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/preproc.html">Preprocessing</a>
    <a class="dropdown-item" href="../../articles/tutorial/tune.html">Tuning</a>
    <a class="dropdown-item" href="../../articles/tutorial/resample.html">Resampling</a>
    <a class="dropdown-item" href="../../articles/tutorial/benchmark_experiments.html">Benchmarking</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/parallelization.html">Parallelization</a>
    <a class="dropdown-item" href="../../articles/tutorial/performance.html">Performance</a>
    <a class="dropdown-item" href="../../articles/tutorial/visualization.html">Visualization</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/usecase_regression.html">Use case - Regression</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-advanced">Advanced</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-advanced">
    <a class="dropdown-item" href="../../articles/tutorial/configureMlr.html">mlr Configuration</a>
    <a class="dropdown-item" href="../../articles/tutorial/wrapper.html">Wrapped Learners</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/impute.html">Imputation</a>
    <a class="dropdown-item" href="../../articles/tutorial/bagging.html">Generic Bagging</a>
    <a class="dropdown-item" href="../../articles/tutorial/advanced_tune.html">Advanced Tuning</a>
    <a class="dropdown-item" href="../../articles/tutorial/feature_selection.html">Feature Selection/Filtering</a>
    <a class="dropdown-item" href="../../articles/tutorial/nested_resampling.html">Nested Resampling</a>
    <a class="dropdown-item" href="../../articles/tutorial/over_and_undersampling.html">Imbalanced Classification Problems</a>
    <a class="dropdown-item" href="../../articles/tutorial/roc_analysis.html">ROC Analysis and Performance Curves</a>
    <a class="dropdown-item" href="../../articles/tutorial/learning_curve.html">Learning Curve Analysis</a>
    <a class="dropdown-item" href="../../articles/tutorial/partial_dependence.html">Partial Dependence Plots</a>
    <a class="dropdown-item" href="../../articles/tutorial/classifier_calibration.html">Classifier Calibration</a>
    <a class="dropdown-item" href="../../articles/tutorial/hyperpar_tuning_effects.html">Hyperparameter Tuning Effects</a>
    <a class="dropdown-item" href="../../articles/tutorial/out_of_bag_predictions.html">Out-of-Bag Predictions</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/multilabel.html">Multilabel Classification</a>
    <a class="dropdown-item" href="../../articles/tutorial/cost_sensitive_classif.html">Cost-Sensitive Classification</a>
    <a class="dropdown-item" href="../../articles/tutorial/handling_of_spatial_data.html">Spatial Data</a>
    <a class="dropdown-item" href="../../articles/tutorial/functional_data.html">Functional Data</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-extending">Extending</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-extending">
    <a class="dropdown-item" href="../../articles/tutorial/create_learner.html">Create Custom Learners</a>
    <a class="dropdown-item" href="../../articles/tutorial/create_measure.html">Create Custom Measures</a>
    <a class="dropdown-item" href="../../articles/tutorial/create_imputation.html">Create Custom Imputation Methods</a>
    <a class="dropdown-item" href="../../articles/tutorial/create_filter.html">Create Custom Filters</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-appendix">Appendix</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-appendix">
    <a class="dropdown-item" href="../../articles/tutorial/example_tasks.html">Integrated Tasks</a>
    <a class="dropdown-item" href="../../articles/tutorial/integrated_learners.html">Integrated Learners</a>
    <a class="dropdown-item" href="../../articles/tutorial/measures.html">Integrated Measures</a>
    <a class="dropdown-item" href="../../articles/tutorial/filter_methods.html">Integrated Filter Methods</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/mlr_publications.html">mlr Publications</a>
    <a class="external-link dropdown-item" href="https://github.com/mlr-org/mlr-outreach">Talks, Videos and Workshops</a>
    <div class="dropdown-divider"></div>
    <a class="external-link dropdown-item" href="https://mlrmbo.mlr-org.com">mlrMBO</a>
    <a class="external-link dropdown-item" href="https://https://mlrcpo.mlr-org.com">mlrCPO</a>
    <a class="external-link dropdown-item" href="https://jakob-r.de/mlrHyperopt/index.html">mlrHyperopt</a>
    <a class="external-link dropdown-item" href="http://openml.github.io/openml-r/">OpenML</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../news/index.html">Changelog</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mlr-org/mlr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa fa fa-comments"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fab fa fab fa-stack-overflow"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Training a Learner</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr/blob/HEAD/vignettes/tutorial/train.Rmd" class="external-link"><code>vignettes/tutorial/train.Rmd</code></a></small>
      <div class="d-none name"><code>train.Rmd</code></div>
    </div>

    
    
<p>Training a learner means fitting a model to a given data set. In <code>mlr</code> this can be done by calling function <code><a href="../../reference/train.html">train()</a></code> on a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) and a suitable <code><a href="../../reference/Task.html">Task()</a></code>.</p>
<p>We start with a classification example and perform a linear discriminant analysis (<code><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">MASS::lda()</a></code>) on the iris (<code><a href="https://rdrr.io/r/datasets/iris.html" class="external-link">datasets::iris()</a></code>) data set.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate the task</span></span>
<span><span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="../../reference/ClassifTask.html">makeClassifTask</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, target <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate the learner</span></span>
<span><span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.lda"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train the learner</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="va">lrn</span>, <span class="va">task</span><span class="op">)</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">## Model for learner.id=classif.lda; learner.class=classif.lda</span></span>
<span><span class="co">## Trained on: task.id = iris; obs = 150; features = 4</span></span>
<span><span class="co">## Hyperparameters:</span></span></code></pre></div>
<p>In the above example creating the Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) explicitly is not absolutely necessary. As a general rule, you have to generate the Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) yourself if you want to change any defaults, e.g., setting hyperparameter values or altering the predict type. Otherwise, <code><a href="../../reference/train.html">train()</a></code> and many other functions also accept the class name of the learner and call <code><a href="../../reference/makeLearner.html">makeLearner()</a></code> internally with default settings.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="st">"classif.lda"</span>, <span class="va">task</span><span class="op">)</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">## Model for learner.id=classif.lda; learner.class=classif.lda</span></span>
<span><span class="co">## Trained on: task.id = iris; obs = 150; features = 4</span></span>
<span><span class="co">## Hyperparameters:</span></span></code></pre></div>
<p>Training a learner works the same way for every type of learning problem. Below is a survival analysis example where a Cox proportional hazards model (<code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph()</a></code>) is fitted to the <code><a href="https://rdrr.io/pkg/survival/man/lung.html" class="external-link">survival::lung()</a></code> data set. Note that we use the corresponding <code><a href="../../reference/lung.task.html">lung.task()</a></code> provided by <code>mlr</code>. All available <code><a href="../../reference/Task.html">Task()</a></code>s are listed in the <a href="example_tasks.html" target="_blank">Appendix</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="st">"surv.coxph"</span>, <span class="va">lung.task</span><span class="op">)</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">## Model for learner.id=surv.coxph; learner.class=surv.coxph</span></span>
<span><span class="co">## Trained on: task.id = lung-example; obs = 167; features = 8</span></span>
<span><span class="co">## Hyperparameters:</span></span></code></pre></div>
<div class="section level2">
<h2 id="accessing-learner-models">Accessing learner models<a class="anchor" aria-label="anchor" href="#accessing-learner-models"></a>
</h2>
<p>Function <code><a href="../../reference/train.html">train()</a></code> returns an object of class <code>WrappedModel</code> (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>), which encapsulates the fitted model, i.e., the output of the underlying <strong>R</strong> learning method. Additionally, it contains some information about the Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>), the <code><a href="../../reference/Task.html">Task()</a></code>, the features and observations used for training, and the training time. A <code>WrappedModel</code> (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>) can subsequently be used to make a prediction (<code><a href="../../reference/predict.WrappedModel.html">predict.WrappedModel()</a></code>) for new observations.</p>
<p>The fitted model in slot <code>$learner.model</code> of the <code>WrappedModel</code> (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>) object can be accessed using function <code>getLearnerModel</code>.</p>
<p>In the following example we cluster the <code>Ruspini</code> (<code><a href="https://rdrr.io/pkg/cluster/man/ruspini.html" class="external-link">cluster::ruspini()</a></code>) data set (which has four groups and two features) by <span class="math inline">\(K\)</span>-means with <span class="math inline">\(K = 4\)</span> and extract the output of the underlying <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">stats::kmeans()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ruspini</span>, package <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">ruspini</span><span class="op">)</span></span></code></pre></div>
<p><img src="train_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate the task</span></span>
<span><span class="va">ruspini.task</span> <span class="op">=</span> <span class="fu"><a href="../../reference/ClusterTask.html">makeClusterTask</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ruspini</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate the learner</span></span>
<span><span class="va">lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"cluster.kmeans"</span>, centers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train the learner</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="va">lrn</span>, <span class="va">ruspini.task</span><span class="op">)</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">## Model for learner.id=cluster.kmeans; learner.class=cluster.kmeans</span></span>
<span><span class="co">## Trained on: task.id = ruspini; obs = 75; features = 2</span></span>
<span><span class="co">## Hyperparameters: centers=4</span></span>
<span></span>
<span><span class="co"># Peak into mod</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">## [1] "learner"       "learner.model" "task.desc"     "subset"       </span></span>
<span><span class="co">## [5] "features"      "factor.levels" "time"          "dump"</span></span>
<span></span>
<span><span class="va">mod</span><span class="op">$</span><span class="va">learner</span></span>
<span><span class="co">## Learner cluster.kmeans from package stats,clue</span></span>
<span><span class="co">## Type: cluster</span></span>
<span><span class="co">## Name: K-Means; Short name: kmeans</span></span>
<span><span class="co">## Class: cluster.kmeans</span></span>
<span><span class="co">## Properties: numerics,prob</span></span>
<span><span class="co">## Predict-Type: response</span></span>
<span><span class="co">## Hyperparameters: centers=4</span></span>
<span></span>
<span><span class="va">mod</span><span class="op">$</span><span class="va">features</span></span>
<span><span class="co">## [1] "x" "y"</span></span>
<span></span>
<span><span class="co"># Extract the fitted model</span></span>
<span><span class="fu"><a href="../../reference/getLearnerModel.html">getLearnerModel</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">## K-means clustering with 4 clusters of sizes 23, 17, 20, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Cluster means:</span></span>
<span><span class="co">##          x        y</span></span>
<span><span class="co">## 1 43.91304 146.0435</span></span>
<span><span class="co">## 2 98.17647 114.8824</span></span>
<span><span class="co">## 3 20.15000  64.9500</span></span>
<span><span class="co">## 4 68.93333  19.4000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Clustering vector:</span></span>
<span><span class="co">##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 </span></span>
<span><span class="co">##  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  1  1  1  1  1  1 </span></span>
<span><span class="co">## 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 </span></span>
<span><span class="co">##  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  2  2 </span></span>
<span><span class="co">## 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 </span></span>
<span><span class="co">##  2  2  2  2  2  2  2  2  4  4  4  4  4  4  4  4  4  4  4  4  4  4  4 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Within cluster sum of squares by cluster:</span></span>
<span><span class="co">## [1] 3176.783 4558.235 3689.500 1456.533</span></span>
<span><span class="co">##  (between_SS / total_SS =  94.7 %)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Available components:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"</span></span>
<span><span class="co">## [6] "betweenss"    "size"         "iter"         "ifault"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="further-options-and-comments">Further options and comments<a class="anchor" aria-label="anchor" href="#further-options-and-comments"></a>
</h2>
<p>By default, the whole data set in the <code><a href="../../reference/Task.html">Task()</a></code> is used for training. The <code>subset</code> argument of <code><a href="../../reference/train.html">train()</a></code> takes a logical or integer vector that indicates which observations to use, for example if you want to split your data into a training and a test set or if you want to fit separate models to different subgroups in the data.</p>
<p>Below we fit a linear regression model (<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code>) to the <code>BostonHousing</code> (<code><a href="https://rdrr.io/pkg/mlbench/man/BostonHousing.html" class="external-link">mlbench::BostonHousing()</a></code>) data set (<code><a href="../../reference/bh.task.html">bh.task()</a></code>) and randomly select 1/3 of the data set for training.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the number of observations</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="../../reference/getTaskSize.html">getTaskSize</a></span><span class="op">(</span><span class="va">bh.task</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use 1/3 of the observations for training</span></span>
<span><span class="va">train.set</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train the learner</span></span>
<span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="st">"regr.lm"</span>, <span class="va">bh.task</span>, subset <span class="op">=</span> <span class="va">train.set</span><span class="op">)</span></span>
<span><span class="va">mod</span></span>
<span><span class="co">## Model for learner.id=regr.lm; learner.class=regr.lm</span></span>
<span><span class="co">## Trained on: task.id = BostonHousing-example; obs = 168; features = 13</span></span>
<span><span class="co">## Hyperparameters:</span></span></code></pre></div>
<p>Note, for later, that all standard <a href="resample.html" target="_blank">resampling strategies</a> are supported. Therefore you usually do not have to subset the data yourself.</p>
<p>Moreover, if the learner supports this, you can specify observation <code>weights</code> that reflect the relevance of observations in the training process. Weights can be useful in many regards, for example to express the reliability of the training observations, reduce the influence of outliers or, if the data were collected over a longer time period, increase the influence of recent data. In supervised classification weights can be used to incorporate misclassification costs or account for class imbalance.</p>
<p>For example in the <code><a href="https://rdrr.io/pkg/mlbench/man/BreastCancer.html" class="external-link">mlbench::BreastCancer()</a></code> data set class <code>benign</code> is almost twice as frequent as class <code>malignant</code>. In order to grant both classes equal importance in training the classifier we can weight the examples according to the inverse class frequencies in the data set as shown in the following <strong>R</strong> code.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the observation weights</span></span>
<span><span class="va">target</span> <span class="op">=</span> <span class="fu"><a href="../../reference/getTaskTargets.html">getTaskTargets</a></span><span class="op">(</span><span class="va">bc.task</span><span class="op">)</span></span>
<span><span class="va">tab</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">target</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">w</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">tab</span><span class="op">[</span><span class="va">target</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="st">"classif.rpart"</span>, task <span class="op">=</span> <span class="va">bc.task</span>, weights <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span>
<span><span class="co">## Model for learner.id=classif.rpart; learner.class=classif.rpart</span></span>
<span><span class="co">## Trained on: task.id = BreastCancer-example; obs = 683; features = 9</span></span>
<span><span class="co">## Hyperparameters: xval=0</span></span></code></pre></div>
<p>Note, for later, that <code>mlr</code> offers much more functionality to deal with <a href="over_and_undersampling.html" target="_blank">imbalanced classification problems</a>.</p>
<p>As another side remark for more advanced readers: By varying the weights in the calls to <code><a href="../../reference/train.html">train()</a></code>, you could also implement your own variant of a general boosting type algorithm on arbitrary <code>mlr</code> base learners.</p>
<p>As you may recall, it is also possible to set observation weights when creating the <code><a href="../../reference/Task.html">Task()</a></code>. As a general rule, you should specify them in <code>make*Task</code> (<code><a href="../../reference/Task.html">Task()</a></code>) if the weights really “belong” to the task and always should be used. Otherwise, pass them to <code><a href="../../reference/train.html">train()</a></code>. The weights in <code><a href="../../reference/train.html">train()</a></code> take precedence over the weights in <code><a href="../../reference/Task.html">Task()</a></code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bernd Bischl, Michel Lang, Lars Kotthoff, Patrick Schratz, Julia Schiffner, Jakob Richter, Zachary Jones, Giuseppe Casalicchio, Mason Gallo.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
