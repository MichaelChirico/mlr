<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mlr">
<title>Functional Data • mlr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../../deps/Roboto-0.4.2/font.css" rel="stylesheet">
<link href="../../deps/JetBrains_Mono-0.4.2/font.css" rel="stylesheet">
<link href="../../deps/Roboto_Slab-0.4.2/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Functional Data">
<meta property="og:description" content="mlr">
<meta property="og:image" content="https://mlr.mlr-org.com/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">mlr</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.19.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-basics">Basics</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-basics">
    <a class="dropdown-item" href="../../articles/tutorial/task.html">Task</a>
    <a class="dropdown-item" href="../../articles/tutorial/learner.html">Learner</a>
    <a class="dropdown-item" href="../../articles/tutorial/train.html">Train</a>
    <a class="dropdown-item" href="../../articles/tutorial/predict.html">Predict</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/preproc.html">Preprocessing</a>
    <a class="dropdown-item" href="../../articles/tutorial/tune.html">Tuning</a>
    <a class="dropdown-item" href="../../articles/tutorial/resample.html">Resampling</a>
    <a class="dropdown-item" href="../../articles/tutorial/benchmark_experiments.html">Benchmarking</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/parallelization.html">Parallelization</a>
    <a class="dropdown-item" href="../../articles/tutorial/performance.html">Performance</a>
    <a class="dropdown-item" href="../../articles/tutorial/visualization.html">Visualization</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/usecase_regression.html">Use case - Regression</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-advanced">Advanced</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-advanced">
    <a class="dropdown-item" href="../../articles/tutorial/configureMlr.html">mlr Configuration</a>
    <a class="dropdown-item" href="../../articles/tutorial/wrapper.html">Wrapped Learners</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/impute.html">Imputation</a>
    <a class="dropdown-item" href="../../articles/tutorial/bagging.html">Generic Bagging</a>
    <a class="dropdown-item" href="../../articles/tutorial/advanced_tune.html">Advanced Tuning</a>
    <a class="dropdown-item" href="../../articles/tutorial/feature_selection.html">Feature Selection/Filtering</a>
    <a class="dropdown-item" href="../../articles/tutorial/nested_resampling.html">Nested Resampling</a>
    <a class="dropdown-item" href="../../articles/tutorial/over_and_undersampling.html">Imbalanced Classification Problems</a>
    <a class="dropdown-item" href="../../articles/tutorial/roc_analysis.html">ROC Analysis and Performance Curves</a>
    <a class="dropdown-item" href="../../articles/tutorial/learning_curve.html">Learning Curve Analysis</a>
    <a class="dropdown-item" href="../../articles/tutorial/partial_dependence.html">Partial Dependence Plots</a>
    <a class="dropdown-item" href="../../articles/tutorial/classifier_calibration.html">Classifier Calibration</a>
    <a class="dropdown-item" href="../../articles/tutorial/hyperpar_tuning_effects.html">Hyperparameter Tuning Effects</a>
    <a class="dropdown-item" href="../../articles/tutorial/out_of_bag_predictions.html">Out-of-Bag Predictions</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/multilabel.html">Multilabel Classification</a>
    <a class="dropdown-item" href="../../articles/tutorial/cost_sensitive_classif.html">Cost-Sensitive Classification</a>
    <a class="dropdown-item" href="../../articles/tutorial/handling_of_spatial_data.html">Spatial Data</a>
    <a class="dropdown-item" href="../../articles/tutorial/functional_data.html">Functional Data</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-extending">Extending</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-extending">
    <a class="dropdown-item" href="../../articles/tutorial/create_learner.html">Create Custom Learners</a>
    <a class="dropdown-item" href="../../articles/tutorial/create_measure.html">Create Custom Measures</a>
    <a class="dropdown-item" href="../../articles/tutorial/create_imputation.html">Create Custom Imputation Methods</a>
    <a class="dropdown-item" href="../../articles/tutorial/create_filter.html">Create Custom Filters</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-appendix">Appendix</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-appendix">
    <a class="dropdown-item" href="../../articles/tutorial/example_tasks.html">Integrated Tasks</a>
    <a class="dropdown-item" href="../../articles/tutorial/integrated_learners.html">Integrated Learners</a>
    <a class="dropdown-item" href="../../articles/tutorial/measures.html">Integrated Measures</a>
    <a class="dropdown-item" href="../../articles/tutorial/filter_methods.html">Integrated Filter Methods</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/tutorial/mlr_publications.html">mlr Publications</a>
    <a class="external-link dropdown-item" href="https://github.com/mlr-org/mlr-outreach">Talks, Videos and Workshops</a>
    <div class="dropdown-divider"></div>
    <a class="external-link dropdown-item" href="https://mlrmbo.mlr-org.com">mlrMBO</a>
    <a class="external-link dropdown-item" href="https://https://mlrcpo.mlr-org.com">mlrCPO</a>
    <a class="external-link dropdown-item" href="https://jakob-r.de/mlrHyperopt/index.html">mlrHyperopt</a>
    <a class="external-link dropdown-item" href="http://openml.github.io/openml-r/">OpenML</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../news/index.html">Changelog</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mlr-org/mlr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa fa fa-comments"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fab fa fab fa-stack-overflow"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Functional Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr/blob/HEAD/vignettes/tutorial/functional_data.Rmd" class="external-link"><code>vignettes/tutorial/functional_data.Rmd</code></a></small>
      <div class="d-none name"><code>functional_data.Rmd</code></div>
    </div>

    
    
<p>In (<a href="http://faculty.bscb.cornell.edu/~hooker/ShortCourseHandout.pdf" class="external-link">Hooker, 2017</a>) it is defined, that “Functional data is multivariate data with an ordering on the dimensions”. It means that this type of data consists of curves varying over a continuum, such as time, frequency, or wavelength. Thus, functional data is often present when measurements at various time points are analyzed. The curves of functional data are usually interdependent, which means that the measurement at a point, e.g., <span class="math inline">\(t_{i + 1}\)</span>, depends on measurements at some other points, e.g., <span class="math inline">\({t_1, ..., t_i}; i \in \mathbb{N}\)</span>.</p>
<p>As the most well-known machine learning techniques generally do not emphasize the interdependence between features, they are often not <em>well suited</em> for such tasks. Application of these techniques can lead to poor performance. Functional data analysis, on the other hand, tries to address this issue either by using algorithms particularly tailored to functional data or by transforming the functional covariates into a continuum (e.g., time, wavelength) nondependent feature space. For a more in-depth introduction to functional data analysis see, e.g. <a href="http://rd.springer.com/article/10.1007/BF02293704" class="external-link">When the data are functions</a> (Ramsay, J.O., 1982).</p>
<p>Each observation of a functional covariate in the data is an evaluation of a functional, i.e., it consists of measurements of a scalar value at various time (wavelength or another type of continuum) points. A single observation might then look like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/boost-R/FDboost" class="external-link">FDboost</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot NIR curve for first observarion</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fuelSubset</span>, package <span class="op">=</span> <span class="st">"FDboost"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># NIR_Obs_1 contains the measurements for NIR of the first functional covariate and</span></span>
<span><span class="co"># lambda indicates the wavelength points the data was measured at.</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"NIR_Obs1"</span> <span class="op">=</span> <span class="va">fuelSubset</span><span class="op">$</span><span class="va">NIR</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>,</span>
<span>  <span class="st">"lambda"</span> <span class="op">=</span> <span class="va">fuelSubset</span><span class="op">$</span><span class="va">nir.lambda</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">NIR_Obs1</span>, x <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="functional_data_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p><em>Note:</em> this is an example of spectroscopic data. NIR stands for “near infra-red radiation (light)”, UVVIS (you will find this below) – “ultra-violet and visible radiation (light)”, and in spectroscopy it is common to denote wavelengths as “lambda” <span class="math inline">\((\lambda)\)</span>. For the sake of simplicity, you can imagine the wavelengths as adjacent visible and invisible “colors” expressed as numbers.</p>
<div class="section level2">
<h2 id="how-to-model-functional-data">How to model functional data?<a class="anchor" aria-label="anchor" href="#how-to-model-functional-data"></a>
</h2>
<p>There are two commonly used approaches for analyzing functional data.</p>
<ul>
<li>Directly analyze the functional data using a <a href="learner.html">learner</a> that is suitable for functional data on a <a href="task.html">task</a>. Those learners have the prefixes <strong>classif.fda</strong> and <strong>regr.fda</strong>.</li>
</ul>
<p>For more info on learners see <a href="functional_data.html#constructing-a-learner">fda learners</a>. For this purpose, the functional data has to be saved as a matrix column in the data frame used for constructing the <a href="task.html">task</a>. For more info on functional tasks, consider the following section.</p>
<ul>
<li>Transform the task into a format suitable for standard <strong>classification</strong> or <strong>regression</strong> <a href="learner.html">learners</a>.</li>
</ul>
<p>This is done by <a href="functional_data.html#feature-extraction">extracting</a> non-temporal/non-functional features from the curves. Non-temporal features do not have any interdependence between each other, similarly to features in traditional machine learning. This is explained in more detail <a href="functional_data.html#feature-extraction">below</a>.</p>
</div>
<div class="section level2">
<h2 id="creating-a-task-that-contains-functional-features">Creating a task that contains functional features<a class="anchor" aria-label="anchor" href="#creating-a-task-that-contains-functional-features"></a>
</h2>
<p>The first step is to get the data in the right format. <code>mlr</code> expects a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">base::data.frame</a></code> which consists of the functional features and the target variable as input. Functional data in contrast to <strong>numeric</strong> data have to be stored as a matrix column in the data frame. After that, a <a href="task.html">task</a> that contains the data in a well-defined format is created. The <a href="task.html">tasks</a> come in different flavors, such as <code><a href="../../reference/ClassifTask.html">makeClassifTask()</a></code> and <code><a href="../../reference/RegrTask.html">makeRegrTask()</a></code>, which can be used according to the class of the target variable.</p>
<p>In the following example, the data is first stored as matrix columns using the helper function <code><a href="../../reference/makeFunctionalData.html">makeFunctionalData()</a></code> for the <a href="&amp;fuelSubset.task">fuelSubset</a> data from package <code>FDboost</code>.</p>
<p>The data is provided in the following structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fuelSubset</span><span class="op">)</span></span>
<span><span class="co">## List of 7</span></span>
<span><span class="co">##  $ heatan      : num [1:129] 26.8 27.5 23.8 18.2 17.5 ...</span></span>
<span><span class="co">##  $ h2o         : num [1:129] 2.3 3 2 1.85 2.39 ...</span></span>
<span><span class="co">##  $ nir.lambda  : num [1:231] 800 803 805 808 810 ...</span></span>
<span><span class="co">##  $ NIR         : num [1:129, 1:231] 0.2818 0.2916 -0.0042 -0.034 -0.1804 ...</span></span>
<span><span class="co">##  $ uvvis.lambda: num [1:134] 250 256 261 267 273 ...</span></span>
<span><span class="co">##  $ UVVIS       : num [1:129, 1:134] 0.145 -1.584 -0.814 -1.311 -1.373 ...</span></span>
<span><span class="co">##  $ h2o.fit     : num [1:129] 2.58 3.43 1.83 2.03 3.07 ...</span></span></code></pre></div>
<ul>
<li>
<strong>heatan</strong> is the target variable, in this case, a numeric value.</li>
<li>
<strong>h2o</strong> is an additional scalar variable.</li>
<li>
<strong>NIR</strong> and <strong>UVVIS</strong> are matrices containing the curve data. Each column corresponds to a single wavelength the data was sampled at. Each row indicates a single curve. <strong>NIR</strong> was measured at 231 wavelength points, while <strong>UVVIS</strong> was measured at 129 wavelength points.</li>
<li>
<strong>nir.lambda</strong> and <strong>uvvis.lambda</strong> are numeric vectors of length 231 and 129 indicate the wavelength points the data was measured at. Each entry corresponds to one column of <strong>NIR</strong> and <strong>UVVIS</strong> respectively. For now, we ignore this additional information in <code>mlr</code>.</li>
</ul>
<p>Our data already contains functional features as matrices in a list. In order to demonstrate how such a matrix can be created from arbitrary numeric columns, we transform the list into a data frame with a set of numeric columns for each matrix. These columns refer to the matrix columns in the list, i.e., <strong>UVVIS.1</strong> is the first column of the UVVIS matrix.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Put all values into a data frame</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">fuelSubset</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"heatan"</span>, <span class="st">"h2o"</span>, <span class="st">"UVVIS"</span>, <span class="st">"NIR"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    129 obs. of  5 variables:</span></span>
<span><span class="co">##  $ heatan : num  26.8 27.5 23.8 18.2 17.5 ...</span></span>
<span><span class="co">##  $ h2o    : num  2.3 3 2 1.85 2.39 ...</span></span>
<span><span class="co">##  $ UVVIS.1: num  0.145 -1.584 -0.814 -1.311 -1.373 ...</span></span>
<span><span class="co">##  $ UVVIS.2: num  -0.0111 -2.0467 -1.053 -1.2445 -1.8826 ...</span></span>
<span><span class="co">##  $ UVVIS.3: num  0.0372 -1.5695 -0.9381 -1.0649 -1.4016 ...</span></span></code></pre></div>
<p>Before constructing the <a href="task.html">task</a>, the data is again reformatted therefore it contains column matrices. This is done by providing a list <strong>fd.features</strong>, that identifies the functional covariates. All columns not mentioned in the list are kept as-is. In our case, the column indices 3:136 correspond to the columns of the UVVIS matrix. Alternatively, we could also specify the respective column names.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mlr.mlr-org.com">mlr</a></span><span class="op">)</span></span>
<span><span class="co"># fd.features is a named list, where each name corresponds to the name of the</span></span>
<span><span class="co"># functional feature and the values to the respective column indices or column names.</span></span>
<span><span class="va">fd.features</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"UVVIS"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">136</span>, <span class="st">"NIR"</span> <span class="op">=</span> <span class="fl">137</span><span class="op">:</span><span class="fl">367</span><span class="op">)</span></span>
<span><span class="va">fdf</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeFunctionalData.html">makeFunctionalData</a></span><span class="op">(</span><span class="va">df</span>, fd.features <span class="op">=</span> <span class="va">fd.features</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../../reference/makeFunctionalData.html">makeFunctionalData()</a></code> returns a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">base::data.frame</a></code>, where the functional features are contained as matrices.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fdf</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    129 obs. of  4 variables:</span></span>
<span><span class="co">##  $ heatan: num  26.8 27.5 23.8 18.2 17.5 ...</span></span>
<span><span class="co">##  $ h2o   : num  2.3 3 2 1.85 2.39 ...</span></span>
<span><span class="co">##  $ UVVIS : num [1:129, 1:134] 0.145 -1.584 -0.814 -1.311 -1.373 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : NULL</span></span>
<span><span class="co">##   .. ..$ : chr [1:134] "UVVIS.1" "UVVIS.2" "UVVIS.3" "UVVIS.4" ...</span></span>
<span><span class="co">##  $ NIR   : num [1:129, 1:231] 0.2818 0.2916 -0.0042 -0.034 -0.1804 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : NULL</span></span>
<span><span class="co">##   .. ..$ : chr [1:231] "NIR.1" "NIR.2" "NIR.3" "NIR.4" ...</span></span></code></pre></div>
<p>Now with a data frame containing the functionals as matrices, a <a href="task.html">task</a> can be created:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a regression task, classification tasks behave analogously</span></span>
<span><span class="co"># In this case we use column indices</span></span>
<span><span class="va">tsk1</span> <span class="op">=</span> <span class="fu"><a href="../../reference/RegrTask.html">makeRegrTask</a></span><span class="op">(</span><span class="st">"fuelsubset"</span>, data <span class="op">=</span> <span class="va">fdf</span>, target <span class="op">=</span> <span class="st">"heatan"</span><span class="op">)</span></span>
<span><span class="va">tsk1</span></span>
<span><span class="co">## Supervised task: fuelsubset</span></span>
<span><span class="co">## Type: regr</span></span>
<span><span class="co">## Target: heatan</span></span>
<span><span class="co">## Observations: 129</span></span>
<span><span class="co">## Features:</span></span>
<span><span class="co">##    numerics     factors     ordered functionals </span></span>
<span><span class="co">##           1           0           0           2 </span></span>
<span><span class="co">## Missings: FALSE</span></span>
<span><span class="co">## Has weights: FALSE</span></span>
<span><span class="co">## Has blocking: FALSE</span></span>
<span><span class="co">## Has coordinates: FALSE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="constructing-a-learner">Constructing a learner<a class="anchor" aria-label="anchor" href="#constructing-a-learner"></a>
</h2>
<p>For functional data, <a href="learner.html">learners</a> are constructed using <code>makeLearner("classif.&lt;R_method_name&gt;")</code> or <code>makeLearner("regr.&lt;R_method_name&gt;")</code> depending on the target variable.</p>
<p>Applying learners to a <a href="task.html">task</a> works in two ways:</p>
<p><strong>Either use a <a href="learner.html">learner</a> suitable for functional data:</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The following learners can be used for tsk1 (a regression task).</span></span>
<span><span class="fu"><a href="../../reference/listLearners.html">listLearners</a></span><span class="op">(</span><span class="va">tsk1</span>, properties <span class="op">=</span> <span class="st">"functionals"</span>, warn.missing.packages <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">##              class                                        name  short.name</span></span>
<span><span class="co">## 1     regr.FDboost Functional linear array regression boosting     FDboost</span></span>
<span><span class="co">## 2 regr.featureless                      Featureless regression featureless</span></span>
<span><span class="co">##          package</span></span>
<span><span class="co">## 1 FDboost,mboost</span></span>
<span><span class="co">## 2            mlr</span></span>
<span><span class="co">##                                                                                                                                                                                                                          note</span></span>
<span><span class="co">## 1 Only allow one base learner for functional covariate and one base learner for scalar covariate, the parameters for these base learners are the same. Also we currently do not support interaction between scalar covariates</span></span>
<span><span class="co">## 2                                                                                                                                                                                                                            </span></span>
<span><span class="co">##   type installed numerics factors ordered missings weights  prob oneclass</span></span>
<span><span class="co">## 1 regr      TRUE     TRUE   FALSE   FALSE    FALSE   FALSE FALSE    FALSE</span></span>
<span><span class="co">## 2 regr      TRUE     TRUE    TRUE    TRUE     TRUE   FALSE FALSE    FALSE</span></span>
<span><span class="co">##   twoclass multiclass class.weights featimp oobpreds functionals</span></span>
<span><span class="co">## 1    FALSE      FALSE         FALSE   FALSE    FALSE        TRUE</span></span>
<span><span class="co">## 2    FALSE      FALSE         FALSE   FALSE    FALSE        TRUE</span></span>
<span><span class="co">##   single.functional    se lcens rcens icens</span></span>
<span><span class="co">## 1             FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co">## 2             FALSE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an FDboost learner for regression</span></span>
<span><span class="va">fdalrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"regr.FDboost"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Or alternatively, use knn for classification:</span></span>
<span><span class="va">knn.lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.fdausc.knn"</span><span class="op">)</span></span></code></pre></div>
<p>Learners can have different properties, depending on whether they support either a <code>single.functional</code> or multiple <code>functionals</code>, i.e. multiple different sensors for the same observation.</p>
<ul>
<li>A learner will have the property <code>functionals</code> if it can handle one or multiple functional covariates.</li>
<li>A learner will have the property <code>single.functional</code> if it can handle only a single functional covariate.</li>
</ul>
<p>We can check for those properties when selecting a leaner:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/LearnerProperties.html">getLearnerProperties</a></span><span class="op">(</span><span class="va">fdalrn</span><span class="op">)</span></span>
<span><span class="co">## [1] "numerics"    "functionals"</span></span></code></pre></div>
<p><strong>or use a standard <a href="learner.html">learner</a>:</strong></p>
<p>In this case, the temporal structure is disregarded, and the functional data treated as simple numeric features.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Decision Tree learner</span></span>
<span><span class="va">rpartlrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"classif.rpart"</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, transform the functional data into a non-temporal/non-functional space by <a href="functional_data.html#feature-extraction">extracting</a> features before training. In this case, a standard regression- or classification-<a href="learner.html">learner</a> can be applied.</p>
<p>This is explained in more detail in the <a href="functional_data.html#feature-extraction">feature extraction</a> section below.</p>
</div>
<div class="section level2">
<h2 id="training-the-learner">Training the learner<a class="anchor" aria-label="anchor" href="#training-the-learner"></a>
</h2>
<p>The resulting <a href="learner.html">learner</a> can now be trained on the task created in section <a href="functional_data.html#creating-a-task">Creating a task</a> above.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Train the fdalrn on the constructed task</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span>learner <span class="op">=</span> <span class="va">fdalrn</span>, task <span class="op">=</span> <span class="va">tsk1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">tsk1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/performance.html">performance</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">rmse</span><span class="op">)</span></span>
<span><span class="co">##     rmse </span></span>
<span><span class="co">## 2.181438</span></span></code></pre></div>
<p>Alternatively, learners that do not explicitly treat functional covariates can be applied. In this case, the temporal structure is completely disregarded, and all columns are treated as independent.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Train a normal learner on the constructed task.</span></span>
<span><span class="co"># Note that we get a message, that functionals have been converted to numerics.</span></span>
<span><span class="va">rpart.lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeLearner.html">makeLearner</a></span><span class="op">(</span><span class="st">"regr.rpart"</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span>learner <span class="op">=</span> <span class="va">rpart.lrn</span>, task <span class="op">=</span> <span class="va">tsk1</span><span class="op">)</span></span>
<span><span class="co">## Functional features have been converted to numerics</span></span>
<span></span>
<span><span class="va">m</span></span>
<span><span class="co">## Model for learner.id=regr.rpart; learner.class=regr.rpart</span></span>
<span><span class="co">## Trained on: task.id = fuelsubset; obs = 129; features = 3</span></span>
<span><span class="co">## Hyperparameters: xval=0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="feature-extraction">Feature extraction<a class="anchor" aria-label="anchor" href="#feature-extraction"></a>
</h2>
<p>In contrast to applying a learner that works on a <a href="task.html">task</a> containing functional features, the <a href="task.html">task</a> can be converted to a standard <a href="task.html">task</a>. This works by transforming the functional features into a non-functional domain, e.g., by extracting wavelets.</p>
<p>The currently supported preprocessing functions are:</p>
<ul>
<li>discrete wavelet transform;</li>
<li>fast Fourier transform;</li>
<li>functional principal component analysis;</li>
<li>multi-resolution feature extraction.</li>
</ul>
<p>In order to do this, we specify methods for each functional feature in the task in a <strong>list</strong>. In this case, we simply want to extract the Fourier transform from each <strong>UVVIS</strong> functional and the Functional PCA Scores from each <strong>NIR</strong> functional. Variable names can be specified multiple times with different extractors. Additional arguments supplied to the <em>extract</em> functions are passed on.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># feat.methods specifies what to extract from which functional</span></span>
<span><span class="co"># In this example, we extract the Fourier transformation from the first functional.</span></span>
<span><span class="co"># From the second functional, fpca scores are extracted.</span></span>
<span><span class="va">feat.methods</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"UVVIS"</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAFourier.html">extractFDAFourier</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"NIR"</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAFPCA.html">extractFDAFPCA</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Either create a new task from an existing task</span></span>
<span><span class="va">extracted</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAFeatures.html">extractFDAFeatures</a></span><span class="op">(</span><span class="va">tsk1</span>, feat.methods <span class="op">=</span> <span class="va">feat.methods</span><span class="op">)</span></span>
<span><span class="va">extracted</span></span>
<span><span class="co">## $task</span></span>
<span><span class="co">## Supervised task: fuelsubset</span></span>
<span><span class="co">## Type: regr</span></span>
<span><span class="co">## Target: heatan</span></span>
<span><span class="co">## Observations: 129</span></span>
<span><span class="co">## Features:</span></span>
<span><span class="co">##    numerics     factors     ordered functionals </span></span>
<span><span class="co">##         264           0           0           0 </span></span>
<span><span class="co">## Missings: FALSE</span></span>
<span><span class="co">## Has weights: FALSE</span></span>
<span><span class="co">## Has blocking: FALSE</span></span>
<span><span class="co">## Has coordinates: FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $desc</span></span>
<span><span class="co">## Extraction of features from functional data:</span></span>
<span><span class="co">## Target: heatan</span></span>
<span><span class="co">## Remaining functional Features: 2 after extraction on 2 functional features</span></span></code></pre></div>
<div class="section level3">
<h3 id="wavelets">Wavelets<a class="anchor" aria-label="anchor" href="#wavelets"></a>
</h3>
<p>In this example, discrete wavelet feature transformation is applied to the data using the function <code>extractFDAWavelets</code>. Discrete wavelet transform decomposes the functional into several <em>wavelets</em>. This essentially transforms the time signal to a time-scale representation, where every wavelet captures the data at a different resolution. We can specify which additional parameters (i.e., the <code>filter</code> (a type of wavelet) and the <code>boundary</code>) in the pars argument. This function returns a regression task of type <em>regr</em> since the raw data contained temporal structure but the transformed data does not inherit temporal structure anymore. For more information on wavelets consider the documentation of <code><a href="https://rdrr.io/pkg/wavelets/man/dwt.html" class="external-link">wavelets::dwt</a></code>. A more comprehensive guide is, for example, given <a href="https://www.cs.unm.edu/~williams/cs530/arfgtw.pdf" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the feature extraction method and generate new task.</span></span>
<span><span class="co"># Here, we use the Haar filter:</span></span>
<span><span class="va">feat.methods</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"UVVIS"</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAWavelets.html">extractFDAWavelets</a></span><span class="op">(</span>filter <span class="op">=</span> <span class="st">"haar"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">task.w</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAFeatures.html">extractFDAFeatures</a></span><span class="op">(</span><span class="va">tsk1</span>, feat.methods <span class="op">=</span> <span class="va">feat.methods</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the Daubechie wavelet with filter length 4.</span></span>
<span><span class="va">feat.methods</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"NIR"</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAWavelets.html">extractFDAWavelets</a></span><span class="op">(</span>filter <span class="op">=</span> <span class="st">"d4"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">task.wd4</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAFeatures.html">extractFDAFeatures</a></span><span class="op">(</span><span class="va">tsk1</span>, feat.methods <span class="op">=</span> <span class="va">feat.methods</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fourier-transformation">Fourier transformation<a class="anchor" aria-label="anchor" href="#fourier-transformation"></a>
</h3>
<p>Now, we use the Fourier feature transformation. The Fourier transform takes a functional and transforms it to a frequency domain by splitting the signal up into its different frequency components. A more detailed tutorial on Fourier transform can be found <a href="http://www0.cs.ucl.ac.uk/teaching/GZ05/03-fourier.pdf" class="external-link">here</a>. Either the amplitude or the phase of the complex Fourier coefficients can be used for analysis. This can be specified in the additional <code>trafo.coeff</code> argument:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the feature extraction method and generate new task.</span></span>
<span><span class="co"># We use the Fourier features and the amplitude for NIR, as well as the phase for UVVIS</span></span>
<span><span class="va">feat.methods</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"NIR"</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAFourier.html">extractFDAFourier</a></span><span class="op">(</span>trafo.coeff <span class="op">=</span> <span class="st">"amplitude"</span><span class="op">)</span>,</span>
<span>  <span class="st">"UVVIS"</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAFourier.html">extractFDAFourier</a></span><span class="op">(</span>trafo.coeff <span class="op">=</span> <span class="st">"phase"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">task.fourier</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAFeatures.html">extractFDAFeatures</a></span><span class="op">(</span><span class="va">tsk1</span>, feat.methods <span class="op">=</span> <span class="va">feat.methods</span><span class="op">)</span></span>
<span><span class="va">task.fourier</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="wrappers">Wrappers<a class="anchor" aria-label="anchor" href="#wrappers"></a>
</h2>
<p>Additionally we can wrap the preprocessing around a standard learner such as <a href="rpart::rpart()">classif.rpart</a>. For additional information, please consider the <a href="wrapper.html#wrapper">Wrappers</a> section.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use a FDAFeatExtractWrapper</span></span>
<span><span class="co"># In this case we extract the Fourier features from the NIR variable</span></span>
<span><span class="va">feat.methods</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"NIR"</span> <span class="op">=</span> <span class="fu"><a href="../../reference/extractFDAFourier.html">extractFDAFourier</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wrapped.lrn</span> <span class="op">=</span> <span class="fu"><a href="../../reference/makeExtractFDAFeatsWrapper.html">makeExtractFDAFeatsWrapper</a></span><span class="op">(</span><span class="st">"regr.rpart"</span>, feat.methods <span class="op">=</span> <span class="va">feat.methods</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># And run the learner</span></span>
<span><span class="fu"><a href="../../reference/train.html">train</a></span><span class="op">(</span><span class="va">wrapped.lrn</span>, <span class="va">fuelsubset.task</span><span class="op">)</span></span>
<span><span class="co">## Functional features have been converted to numerics</span></span>
<span><span class="co">## Model for learner.id=regr.rpart.extracted; learner.class=extractFDAFeatsWrapper</span></span>
<span><span class="co">## Trained on: task.id = fs.fdf; obs = 129; features = 3</span></span>
<span><span class="co">## Hyperparameters: xval=0</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bernd Bischl, Michel Lang, Lars Kotthoff, Patrick Schratz, Julia Schiffner, Jakob Richter, Zachary Jones, Giuseppe Casalicchio, Mason Gallo.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
